///////////////////////////////////////////////////////////////////////////////
//                                                                            /
// IAR C/C++ Compiler V8.20.2.41139 for 8051            13/Jun/2013  14:53:45 /
// Copyright 2004-2013 IAR Systems AB.                                        /
//                                                                            /
//    Core               =  plain                                             /
//    Code model         =  banked                                            /
//    Data model         =  large                                             /
//    Calling convention =  xdata reentrant                                   /
//    Constant location  =  data_rom                                          /
//    Dptr setup         =  1,16                                              /
//                                                                            /
//    Source file        =  C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\Source\SimpleMeter\simplemeter.c   /
//    Command line       =  -f C:\Users\PedroZ\Documents\GitHub\TG\Projects\S /
//                          tack\SE\SampleApp\CC2530DB\..\..\..\Tools\CC2530D /
//                          B\f8wEndev.cfg (-DCPU32MHZ -DROOT=__near_func     /
//                          -DMAC_CFG_TX_DATA_MAX=3 -DMAC_CFG_TX_MAX=6        /
//                          -DMAC_CFG_RX_MAX=3) -f C:\Users\PedroZ\Documents\ /
//                          GitHub\TG\Projects\Stack\SE\SampleApp\CC2530DB\.. /
//                          \..\..\Tools\CC2530DB\f8wConfig.cfg (-DZIGBEEPRO  /
//                          -DSECURE=0 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR      /
//                          -DDEFAULT_CHANLIST=0x00000800                     /
//                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                      /
//                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_M /
//                          ASK=0x007F -DBEACON_REQUEST_DELAY=100             /
//                          -DBEACON_REQ_DELAY_MASK=0x00FF                    /
//                          -DLINK_STATUS_JITTER_MASK=0x007F                  /
//                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_P /
//                          OLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7           /
//                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3   /
//                          -DNWK_MAX_DATA_RETRIES=2                          /
//                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9        /
//                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40          /
//                          -DNWK_MAX_BINDING_ENTRIES=4                       /
//                          -DMAX_BINDING_CLUSTER_IDS=4                       /
//                          "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07, 0x09,     /
//                          0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08,   /
//                          0x0A, 0x0C, 0x0D}" -DMAC_MAX_FRAME_SIZE=116       /
//                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const    /
//                          __code" -DGENERIC=__generic                       /
//                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000       /
//                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100   /
//                          -DREJOIN_POLL_RATE=440) -f                        /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\Tools\CC2530DB\f /
//                          8wZCL.cfg (-DZCL_READ -DZCL_WRITE -DZCL_BASIC     /
//                          -DZCL_IDENTIFY -DZCL_ON_OFF -DZCL_KEY_ESTABLISH   /
//                          -DZCL_KEY_ESTABLISHMENT_KEY_GENERATE_TIMEOUT=4    /
//                          -DZCL_KEY_ESTABLISHMENT_MAC_GENERATE_TIMEOUT=10   /
//                          -DZCL_KEY_ESTABLISHMENT_EKEY_GENERATE_TIMEOUT=10  /
//                          -DZCL_LOAD_CONTROL -DZCL_SIMPLE_METERING          /
//                          -DZCL_PRICING -DZCL_MESSAGE -DZCL_TUNNELING       /
//                          -DZCL_TOU) -DZCL_DEVICE_MGMT                      /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\Source\SimpleMeter\simplemeter.c   /
//                          -D TC_LINKKEY_JOIN -D ZTOOL_P1 -D MT_TASK -D      /
//                          MT_APP_FUNC -D MT_SYS_FUNC -D LCD_SUPPORTED -D    /
//                          NV_INIT -D xNV_RESTORE -D HOLD_AUTO_START -D      /
//                          NWK_AUTO_POLL -D ZCL_REPORT -D POWER_SAVING -D    /
//                          MAX_POLL_FAILURE_RETRIES=20 -D TEST_CERT_DATA     /
//                          -lC "C:\Users\PedroZ\Documents\GitHub\TG\Projects /
//                          \Stack\SE\SampleApp\CC2530DB\Simple Metering -    /
//                          EndDevice\List\" -lA "C:\Users\PedroZ\Documents\G /
//                          itHub\TG\Projects\Stack\SE\SampleApp\CC2530DB\Sim /
//                          ple Metering - EndDevice\List\" --diag_suppress   /
//                          Pe001,Pa010 -o "C:\Users\PedroZ\Documents\GitHub\ /
//                          TG\Projects\Stack\SE\SampleApp\CC2530DB\Simple    /
//                          Metering - EndDevice\Obj\" -e --no_cse            /
//                          --no_unroll --no_inline --no_code_motion          /
//                          --no_tbaa --debug --core=plain --dptr=16,1        /
//                          --data_model=large --code_model=banked            /
//                          --calling_convention=xdata_reentrant              /
//                          --place_constants=data_rom --nr_virtual_regs 16   /
//                          -I C:\Users\PedroZ\Documents\GitHub\TG\Projects\S /
//                          tack\SE\SampleApp\CC2530DB\ -I                    /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\Source\ -I             /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\Source\ -I          /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\ZMain\TI2530DB\  /
//                          -I C:\Users\PedroZ\Documents\GitHub\TG\Projects\S /
//                          tack\SE\SampleApp\CC2530DB\..\..\..\..\..\Compone /
//                          nts\hal\include\ -I C:\Users\PedroZ\Documents\Git /
//                          Hub\TG\Projects\Stack\SE\SampleApp\CC2530DB\..\.. /
//                          \..\..\..\Components\hal\target\CC2530EB\ -I      /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \mac\include\ -I C:\Users\PedroZ\Documents\GitHub /
//                          \TG\Projects\Stack\SE\SampleApp\CC2530DB\..\..\.. /
//                          \..\..\Components\mac\high_level\ -I              /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \mac\low_level\srf04\ -I                          /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \mac\low_level\srf04\single_chip\ -I              /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \mt\ -I C:\Users\PedroZ\Documents\GitHub\TG\Proje /
//                          cts\Stack\SE\SampleApp\CC2530DB\..\..\..\..\..\Co /
//                          mponents\osal\include\ -I                         /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \services\saddr\ -I C:\Users\PedroZ\Documents\Git /
//                          Hub\TG\Projects\Stack\SE\SampleApp\CC2530DB\..\.. /
//                          \..\..\..\Components\services\sdata\ -I           /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \stack\af\ -I C:\Users\PedroZ\Documents\GitHub\TG /
//                          \Projects\Stack\SE\SampleApp\CC2530DB\..\..\..\.. /
//                          \..\Components\stack\nwk\ -I                      /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \stack\sapi\ -I C:\Users\PedroZ\Documents\GitHub\ /
//                          TG\Projects\Stack\SE\SampleApp\CC2530DB\..\..\..\ /
//                          ..\..\Components\stack\sec\ -I                    /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \stack\sys\ -I C:\Users\PedroZ\Documents\GitHub\T /
//                          G\Projects\Stack\SE\SampleApp\CC2530DB\..\..\..\. /
//                          .\..\Components\stack\zcl\ -I                     /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \stack\zdo\ -I C:\Users\PedroZ\Documents\GitHub\T /
//                          G\Projects\Stack\SE\SampleApp\CC2530DB\..\..\..\. /
//                          .\..\Components\zmac\ -I                          /
//                          C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\..\..\..\..\..\Components /
//                          \zmac\f8w\ -On --require_prototypes               /
//    List file          =  C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stac /
//                          k\SE\SampleApp\CC2530DB\Simple Metering -         /
//                          EndDevice\List\simplemeter.s51                    /
//                                                                            /
//                                                                            /
///////////////////////////////////////////////////////////////////////////////

        NAME simplemeter

        RTMODEL "__SystemLibrary", "CLib"
        RTMODEL "__calling_convention", "xdata_reentrant"
        RTMODEL "__code_model", "banked"
        RTMODEL "__core", "plain"
        RTMODEL "__data_model", "large"
        RTMODEL "__dptr_size", "16"
        RTMODEL "__extended_stack", "disabled"
        RTMODEL "__location_for_constants", "data"
        RTMODEL "__number_of_dptrs", "1"
        RTMODEL "__rt_version", "1"

        RSEG DOVERLAY:DATA:NOROOT(0)
        RSEG IOVERLAY:IDATA:NOROOT(0)
        RSEG ISTACK:IDATA:NOROOT(0)
        RSEG PSTACK:XDATA:NOROOT(0)
        RSEG XSTACK:XDATA:NOROOT(0)

        EXTERN ?ALLOC_XSTACK8
        EXTERN ?BANKED_ENTER_XDATA
        EXTERN ?BANKED_LEAVE_XDATA
        EXTERN ?BDISPATCH
        EXTERN ?BRET
        EXTERN ?DEALLOC_XSTACK8
        EXTERN ?L_MOV_X
        EXTERN ?MOVE_LONG8_XDATA_XDATA
        EXTERN ?PUSH_XSTACK8_X_TWO
        EXTERN ?PUSH_XSTACK_I_FOUR
        EXTERN ?PUSH_XSTACK_I_ONE
        EXTERN ?PUSH_XSTACK_I_TWO
        EXTERN ?V0
        EXTERN ?XSP
        EXTERN ?XSTACK_DISP0_8
        EXTERN ?XSTORE_R2345
        EXTERN __INIT_XDATA_I
        EXTERN __INIT_XDATA_Z

        FUNCTION ??simplemeter_AlarmCB?relay,0203H
        FUNCTION ??simplemeter_BasicResetCB?relay,0203H
        FUNCTION ??simplemeter_GetProfileCmdCB?relay,0203H
        FUNCTION ??simplemeter_GetProfileRspCB?relay,0203H
        FUNCTION ??simplemeter_HandleKeys?relay,0203H
        FUNCTION ??simplemeter_IdentifyCB?relay,0203H
        FUNCTION ??simplemeter_IdentifyQueryRspCB?relay,0203H
        PUBLIC ??simplemeter_Init?relay
        FUNCTION ??simplemeter_Init?relay,0203H
        FUNCTION ??simplemeter_MirrorRemRspCB?relay,0203H
        FUNCTION ??simplemeter_ProcessIdentifyTimeChange?relay,0203H
        FUNCTION ??simplemeter_ProcessInConfigReportCmd?relay,0203H
        FUNCTION ??simplemeter_ProcessInConfigReportRspCmd?relay,0203H
        FUNCTION ??simplemeter_ProcessInDefaultRspCmd?relay,0203H
        FUNCTION ??simplemeter_ProcessInReadReportCfgCmd?relay,0203H
        FUNCTION ??simplemeter_ProcessInReadReportCfgRspCmd?rela,0203H
        FUNCTION ??simplemeter_ProcessInReadRspCmd?relay,0203H
        FUNCTION ??simplemeter_ProcessInReportCmd?relay,0203H
        FUNCTION ??simplemeter_ProcessInWriteRspCmd?relay,0203H
        FUNCTION ??simplemeter_ProcessZCLMsg?relay,0203H
        FUNCTION ??simplemeter_ProcessZDOMsgs?relay,0203H
        FUNCTION ??simplemeter_ReqMirrorRspCB?relay,0203H
        FUNCTION ??simplemeter_ValidateAttrDataCB?relay,0203H
        PUBLIC ??simplemeter_event_loop?relay
        FUNCTION ??simplemeter_event_loop?relay,0203H
        FUNCTION simplemeter_AlarmCB,0603H
        ARGFRAME XSTACK, 0, STACK
        FUNCTION simplemeter_BasicResetCB,0603H
        ARGFRAME XSTACK, 0, STACK
        FUNCTION simplemeter_GetProfileCmdCB,021603H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 51, STACK
        FUNCTION simplemeter_GetProfileRspCB,0603H
        ARGFRAME XSTACK, 0, STACK
        FUNCTION simplemeter_HandleKeys,0a1203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 21, STACK
        FUNCTION simplemeter_IdentifyCB,021603H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        FUNCTION simplemeter_IdentifyQueryRspCB,0603H
        ARGFRAME XSTACK, 0, STACK
        PUBLIC simplemeter_Init
        FUNCTION simplemeter_Init,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 9, STACK
        FUNCTION simplemeter_MirrorRemRspCB,021603H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        FUNCTION simplemeter_ProcessIdentifyTimeChange,021203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        FUNCTION simplemeter_ProcessInConfigReportCmd,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME XSTACK, 33, STACK
        FUNCTION simplemeter_ProcessInConfigReportRspCmd,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 24, STACK
        FUNCTION simplemeter_ProcessInDefaultRspCmd,0203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCTION simplemeter_ProcessInReadReportCfgCmd,021203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME ISTACK, 1, STACK
        LOCFRAME XSTACK, 39, STACK
        FUNCTION simplemeter_ProcessInReadReportCfgRspCmd,0203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 10, STACK
        FUNCTION simplemeter_ProcessInReadRspCmd,0203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        FUNCTION simplemeter_ProcessInReportCmd,0203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        FUNCTION simplemeter_ProcessInWriteRspCmd,0203H
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        FUNCTION simplemeter_ProcessZCLMsg,021203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 9, STACK
        FUNCTION simplemeter_ProcessZDOMsgs,021203H
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        LOCFRAME XSTACK, 12, STACK
        FUNCTION simplemeter_ReqMirrorRspCB,0603H
        ARGFRAME XSTACK, 0, STACK
        FUNCTION simplemeter_ValidateAttrDataCB,0603H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME ISTACK, 2, STACK
        PUBLIC simplemeter_event_loop
        FUNCTION simplemeter_event_loop,021203H
        ARGFRAME XSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        
          CFI Names cfiNames0
          CFI StackFrame CFA_SP SP IDATA
          CFI StackFrame CFA_PSP16 PSP16 XDATA
          CFI StackFrame CFA_XSP16 XSP16 XDATA
          CFI StaticOverlayFrame CFA_IOVERLAY IOVERLAY
          CFI StaticOverlayFrame CFA_DOVERLAY DOVERLAY
          CFI Resource `PSW.CY`:1, `B.BR0`:1, `B.BR1`:1, `B.BR2`:1, `B.BR3`:1
          CFI Resource `B.BR4`:1, `B.BR5`:1, `B.BR6`:1, `B.BR7`:1, `VB.BR8`:1
          CFI Resource `VB.BR9`:1, `VB.BR10`:1, `VB.BR11`:1, `VB.BR12`:1
          CFI Resource `VB.BR13`:1, `VB.BR14`:1, `VB.BR15`:1, VB:8, B:8, A:8
          CFI Resource PSW:8, DPL0:8, DPH0:8, R0:8, R1:8, R2:8, R3:8, R4:8, R5:8
          CFI Resource R6:8, R7:8, V0:8, V1:8, V2:8, V3:8, V4:8, V5:8, V6:8, V7:8
          CFI Resource V8:8, V9:8, V10:8, V11:8, V12:8, V13:8, V14:8, V15:8, SP:8
          CFI Resource PSPH:8, PSPL:8, PSP16:16, XSPH:8, XSPL:8, XSP16:16
          CFI VirtualResource ?RET:24
          CFI Resource ?BRET_EXT:8
          CFI VirtualResource ?RET_HIGH:8, ?RET_LOW:8
          CFI ResourceParts PSP16 PSPH, PSPL
          CFI ResourceParts XSP16 XSPH, XSPL
          CFI ResourceParts ?RET ?BRET_EXT, ?RET_HIGH, ?RET_LOW
          CFI EndNames cfiNames0
        
          CFI Common cfiCommon0 Using cfiNames0
          CFI CodeAlign 1
          CFI DataAlign -1
          CFI ReturnAddress ?RET CODE
          CFI CFA_DOVERLAY Used
          CFI CFA_IOVERLAY Used
          CFI CFA_SP SP+-3
          CFI CFA_PSP16 PSP16+0
          CFI CFA_XSP16 XSP16+0
          CFI `PSW.CY` SameValue
          CFI `B.BR0` SameValue
          CFI `B.BR1` SameValue
          CFI `B.BR2` SameValue
          CFI `B.BR3` SameValue
          CFI `B.BR4` SameValue
          CFI `B.BR5` SameValue
          CFI `B.BR6` SameValue
          CFI `B.BR7` SameValue
          CFI `VB.BR8` SameValue
          CFI `VB.BR9` SameValue
          CFI `VB.BR10` SameValue
          CFI `VB.BR11` SameValue
          CFI `VB.BR12` SameValue
          CFI `VB.BR13` SameValue
          CFI `VB.BR14` SameValue
          CFI `VB.BR15` SameValue
          CFI VB SameValue
          CFI B Undefined
          CFI A Undefined
          CFI PSW SameValue
          CFI DPL0 SameValue
          CFI DPH0 SameValue
          CFI R0 Undefined
          CFI R1 Undefined
          CFI R2 Undefined
          CFI R3 Undefined
          CFI R4 Undefined
          CFI R5 Undefined
          CFI R6 SameValue
          CFI R7 SameValue
          CFI V0 SameValue
          CFI V1 SameValue
          CFI V2 SameValue
          CFI V3 SameValue
          CFI V4 SameValue
          CFI V5 SameValue
          CFI V6 SameValue
          CFI V7 SameValue
          CFI V8 SameValue
          CFI V9 SameValue
          CFI V10 SameValue
          CFI V11 SameValue
          CFI V12 SameValue
          CFI V13 SameValue
          CFI V14 SameValue
          CFI V15 SameValue
          CFI PSPH Undefined
          CFI PSPL Undefined
          CFI XSPH Undefined
          CFI XSPL Undefined
          CFI ?RET Concat
          CFI ?BRET_EXT Frame(CFA_SP, 3)
          CFI ?RET_HIGH Frame(CFA_SP, 2)
          CFI ?RET_LOW Frame(CFA_SP, 1)
          CFI EndCommon cfiCommon0
        
HalLedBlink         SYMBOL "HalLedBlink"
??HalLedBlink?relay SYMBOL "?relay", HalLedBlink
HalLedSet           SYMBOL "HalLedSet"
??HalLedSet?relay   SYMBOL "?relay", HalLedSet
NLME_SetPollRate    SYMBOL "NLME_SetPollRate"
??NLME_SetPollRate?relay SYMBOL "?relay", NLME_SetPollRate
RegisterForKeys     SYMBOL "RegisterForKeys"
??RegisterForKeys?relay SYMBOL "?relay", RegisterForKeys
ZDOInitDevice       SYMBOL "ZDOInitDevice"
??ZDOInitDevice?relay SYMBOL "?relay", ZDOInitDevice
ZDO_ParseEPListRsp  SYMBOL "ZDO_ParseEPListRsp"
??ZDO_ParseEPListRsp?relay SYMBOL "?relay", ZDO_ParseEPListRsp
ZDO_RegisterForZDOMsg SYMBOL "ZDO_RegisterForZDOMsg"
??ZDO_RegisterForZDOMsg?relay SYMBOL "?relay", ZDO_RegisterForZDOMsg
osal_getClock       SYMBOL "osal_getClock"
??osal_getClock?relay SYMBOL "?relay", osal_getClock
osal_mem_alloc      SYMBOL "osal_mem_alloc"
??osal_mem_alloc?relay SYMBOL "?relay", osal_mem_alloc
osal_mem_free       SYMBOL "osal_mem_free"
??osal_mem_free?relay SYMBOL "?relay", osal_mem_free
osal_msg_deallocate SYMBOL "osal_msg_deallocate"
??osal_msg_deallocate?relay SYMBOL "?relay", osal_msg_deallocate
osal_msg_receive    SYMBOL "osal_msg_receive"
??osal_msg_receive?relay SYMBOL "?relay", osal_msg_receive
osal_set_event      SYMBOL "osal_set_event"
??osal_set_event?relay SYMBOL "?relay", osal_set_event
osal_start_timerEx  SYMBOL "osal_start_timerEx"
??osal_start_timerEx?relay SYMBOL "?relay", osal_start_timerEx
osal_stop_timerEx   SYMBOL "osal_stop_timerEx"
??osal_stop_timerEx?relay SYMBOL "?relay", osal_stop_timerEx
zclAnalogDataType   SYMBOL "zclAnalogDataType"
??zclAnalogDataType?relay SYMBOL "?relay", zclAnalogDataType
zclFindAttrRec      SYMBOL "zclFindAttrRec"
??zclFindAttrRec?relay SYMBOL "?relay", zclFindAttrRec
zclGeneral_KeyEstablish_InitiateKeyEstablishment SYMBOL "zclGeneral_KeyEstablish_InitiateKeyEstablishment"
??zclGeneral_KeyEstablish_InitiateKeyEstablishm SYMBOL "?relay", zclGeneral_KeyEstablish_InitiateKeyEstablishment
zclGeneral_RegisterCmdCallbacks SYMBOL "zclGeneral_RegisterCmdCallbacks"
??zclGeneral_RegisterCmdCallbacks?relay SYMBOL "?relay", zclGeneral_RegisterCmdCallbacks
zclGetDataTypeLength SYMBOL "zclGetDataTypeLength"
??zclGetDataTypeLength?relay SYMBOL "?relay", zclGetDataTypeLength
zclSE_Init          SYMBOL "zclSE_Init"
??zclSE_Init?relay  SYMBOL "?relay", zclSE_Init
zclSE_RegisterCmdCallbacks SYMBOL "zclSE_RegisterCmdCallbacks"
??zclSE_RegisterCmdCallbacks?relay SYMBOL "?relay", zclSE_RegisterCmdCallbacks
zclSE_SimpleMetering_Send_GetProfileRsp SYMBOL "zclSE_SimpleMetering_Send_GetProfileRsp"
??zclSE_SimpleMetering_Send_GetProfileRsp?relay SYMBOL "?relay", zclSE_SimpleMetering_Send_GetProfileRsp
zcl_SendCommand     SYMBOL "zcl_SendCommand"
??zcl_SendCommand?relay SYMBOL "?relay", zcl_SendCommand
zcl_SendConfigReportRspCmd SYMBOL "zcl_SendConfigReportRspCmd"
??zcl_SendConfigReportRspCmd?relay SYMBOL "?relay", zcl_SendConfigReportRspCmd
zcl_SendReadReportCfgRspCmd SYMBOL "zcl_SendReadReportCfgRspCmd"
??zcl_SendReadReportCfgRspCmd?relay SYMBOL "?relay", zcl_SendReadReportCfgRspCmd
zcl_SendReportCmd   SYMBOL "zcl_SendReportCmd"
??zcl_SendReportCmd?relay SYMBOL "?relay", zcl_SendReportCmd
zcl_registerAttrList SYMBOL "zcl_registerAttrList"
??zcl_registerAttrList?relay SYMBOL "?relay", zcl_registerAttrList
zcl_registerClusterOptionList SYMBOL "zcl_registerClusterOptionList"
??zcl_registerClusterOptionList?relay SYMBOL "?relay", zcl_registerClusterOptionList
zcl_registerForMsg  SYMBOL "zcl_registerForMsg"
??zcl_registerForMsg?relay SYMBOL "?relay", zcl_registerForMsg
zcl_registerValidateAttrData SYMBOL "zcl_registerValidateAttrData"
??zcl_registerValidateAttrData?relay SYMBOL "?relay", zcl_registerValidateAttrData
simplemeter_Init    SYMBOL "simplemeter_Init"
??simplemeter_Init?relay SYMBOL "?relay", simplemeter_Init
simplemeter_event_loop SYMBOL "simplemeter_event_loop"
??simplemeter_event_loop?relay SYMBOL "?relay", simplemeter_event_loop

        EXTERN ??HalLedBlink?relay
        FUNCTION ??HalLedBlink?relay,00H
        EXTERN ??HalLedSet?relay
        FUNCTION ??HalLedSet?relay,00H
        EXTERN ??NLME_SetPollRate?relay
        FUNCTION ??NLME_SetPollRate?relay,00H
        EXTERN ??RegisterForKeys?relay
        FUNCTION ??RegisterForKeys?relay,00H
        EXTERN ??ZDOInitDevice?relay
        FUNCTION ??ZDOInitDevice?relay,00H
        EXTERN ??ZDO_ParseEPListRsp?relay
        FUNCTION ??ZDO_ParseEPListRsp?relay,00H
        EXTERN ??ZDO_RegisterForZDOMsg?relay
        FUNCTION ??ZDO_RegisterForZDOMsg?relay,00H
        EXTERN ??osal_getClock?relay
        FUNCTION ??osal_getClock?relay,00H
        EXTERN ??osal_mem_alloc?relay
        FUNCTION ??osal_mem_alloc?relay,00H
        EXTERN ??osal_mem_free?relay
        FUNCTION ??osal_mem_free?relay,00H
        EXTERN ??osal_msg_deallocate?relay
        FUNCTION ??osal_msg_deallocate?relay,00H
        EXTERN ??osal_msg_receive?relay
        FUNCTION ??osal_msg_receive?relay,00H
        EXTERN ??osal_set_event?relay
        FUNCTION ??osal_set_event?relay,00H
        EXTERN ??osal_start_timerEx?relay
        FUNCTION ??osal_start_timerEx?relay,00H
        EXTERN ??osal_stop_timerEx?relay
        FUNCTION ??osal_stop_timerEx?relay,00H
        EXTERN ??zclAnalogDataType?relay
        FUNCTION ??zclAnalogDataType?relay,00H
        EXTERN ??zclFindAttrRec?relay
        FUNCTION ??zclFindAttrRec?relay,00H
        EXTERN ??zclGeneral_KeyEstablish_InitiateKeyEstablishm
        FUNCTION ??zclGeneral_KeyEstablish_InitiateKeyEstablishm,00H
        EXTERN ??zclGeneral_RegisterCmdCallbacks?relay
        FUNCTION ??zclGeneral_RegisterCmdCallbacks?relay,00H
        EXTERN ??zclGetDataTypeLength?relay
        FUNCTION ??zclGetDataTypeLength?relay,00H
        EXTERN ??zclSE_Init?relay
        FUNCTION ??zclSE_Init?relay,00H
        EXTERN ??zclSE_RegisterCmdCallbacks?relay
        FUNCTION ??zclSE_RegisterCmdCallbacks?relay,00H
        EXTERN ??zclSE_SimpleMetering_Send_GetProfileRsp?relay
        FUNCTION ??zclSE_SimpleMetering_Send_GetProfileRsp?relay,00H
        EXTERN ??zcl_SendCommand?relay
        FUNCTION ??zcl_SendCommand?relay,00H
        EXTERN ??zcl_SendConfigReportRspCmd?relay
        FUNCTION ??zcl_SendConfigReportRspCmd?relay,00H
        EXTERN ??zcl_SendReadReportCfgRspCmd?relay
        FUNCTION ??zcl_SendReadReportCfgRspCmd?relay,00H
        EXTERN ??zcl_SendReportCmd?relay
        FUNCTION ??zcl_SendReportCmd?relay,00H
        EXTERN ??zcl_registerAttrList?relay
        FUNCTION ??zcl_registerAttrList?relay,00H
        EXTERN ??zcl_registerClusterOptionList?relay
        FUNCTION ??zcl_registerClusterOptionList?relay,00H
        EXTERN ??zcl_registerForMsg?relay
        FUNCTION ??zcl_registerForMsg?relay,00H
        EXTERN ??zcl_registerValidateAttrData?relay
        FUNCTION ??zcl_registerValidateAttrData?relay,00H
        EXTERN HalLedBlink
        FUNCTION HalLedBlink,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN HalLedSet
        FUNCTION HalLedSet,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN NLME_SetPollRate
        FUNCTION NLME_SetPollRate,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN RegisterForKeys
        FUNCTION RegisterForKeys,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDOInitDevice
        FUNCTION ZDOInitDevice,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDO_ParseEPListRsp
        FUNCTION ZDO_ParseEPListRsp,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN ZDO_RegisterForZDOMsg
        FUNCTION ZDO_RegisterForZDOMsg,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_getClock
        FUNCTION osal_getClock,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_mem_alloc
        FUNCTION osal_mem_alloc,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_mem_free
        FUNCTION osal_mem_free,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_msg_deallocate
        FUNCTION osal_msg_deallocate,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_msg_receive
        FUNCTION osal_msg_receive,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_set_event
        FUNCTION osal_set_event,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_start_timerEx
        FUNCTION osal_start_timerEx,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN osal_stop_timerEx
        FUNCTION osal_stop_timerEx,0202H
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN simpleMeterAttrs
        EXTERN simpleMeterCurrentSummationDelivered
        EXTERN simpleMeterDeviceType
        EXTERN simpleMeterIdentifyTime
        EXTERN simpleMeterOptions
        EXTERN simpleMeterPowerSource
        EXTERN simpleMeterSimpleDesc
        EXTERN simpleMeterStatus
        EXTERN simpleMeterSummationFormating
        EXTERN simpleMeterTime
        EXTERN simpleMeterUnitOfMeasure
        EXTERN simpleMeterZCLVersion
        EXTERN zclAnalogDataType
        FUNCTION zclAnalogDataType,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zclFindAttrRec
        FUNCTION zclFindAttrRec,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zclGeneral_KeyEstablish_InitiateKeyEstablishment
        FUNCTION zclGeneral_KeyEstablish_InitiateKeyEstablishment,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zclGeneral_RegisterCmdCallbacks
        FUNCTION zclGeneral_RegisterCmdCallbacks,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zclGetDataTypeLength
        FUNCTION zclGetDataTypeLength,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zclSE_Init
        FUNCTION zclSE_Init,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zclSE_RegisterCmdCallbacks
        FUNCTION zclSE_RegisterCmdCallbacks,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zclSE_SimpleMetering_Send_GetProfileRsp
        FUNCTION zclSE_SimpleMetering_Send_GetProfileRsp,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 51, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zcl_SendCommand
        FUNCTION zcl_SendCommand,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zcl_SendConfigReportRspCmd
        FUNCTION zcl_SendConfigReportRspCmd,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zcl_SendReadReportCfgRspCmd
        FUNCTION zcl_SendReadReportCfgRspCmd,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 39, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zcl_SendReportCmd
        FUNCTION zcl_SendReportCmd,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zcl_registerAttrList
        FUNCTION zcl_registerAttrList,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zcl_registerClusterOptionList
        FUNCTION zcl_registerClusterOptionList,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zcl_registerForMsg
        FUNCTION zcl_registerForMsg,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        EXTERN zcl_registerValidateAttrData
        FUNCTION zcl_registerValidateAttrData,0202H
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC

// C:\Users\PedroZ\Documents\GitHub\TG\Projects\Stack\SE\SampleApp\Source\SimpleMeter\simplemeter.c
//    1 /**************************************************************************************************
//    2   Filename:       simplemeter.c
//    3   Revised:        $Date: 2012-04-02 17:02:19 -0700 (Mon, 02 Apr 2012) $
//    4   Revision:       $Revision: 29996 $
//    5 
//    6   Description:    This module implements the Simple Meter functionality and
//    7                   contains the init and event loop functions
//    8 
//    9 
//   10   Copyright 2009-2012 Texas Instruments Incorporated. All rights reserved.
//   11 
//   12   IMPORTANT: Your use of this Software is limited to those specific rights
//   13   granted under the terms of a software license agreement between the user
//   14   who downloaded the software, his/her employer (which must be your employer)
//   15   and Texas Instruments Incorporated (the "License").  You may not use this
//   16   Software unless you agree to abide by the terms of the License. The License
//   17   limits your use, and you acknowledge, that the Software may not be modified,
//   18   copied or distributed unless embedded on a Texas Instruments microcontroller
//   19   or used solely and exclusively in conjunction with a Texas Instruments radio
//   20   frequency transceiver, which is integrated into your product.  Other than for
//   21   the foregoing purpose, you may not use, reproduce, copy, prepare derivative
//   22   works of, modify, distribute, perform, display or sell this Software and/or
//   23   its documentation for any purpose.
//   24 
//   25   YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
//   26   PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
//   27   INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
//   28   NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
//   29   TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
//   30   NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
//   31   LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
//   32   INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
//   33   OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
//   34   OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
//   35   (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
//   36 
//   37   Should you have any questions regarding your right to use this Software,
//   38   contact Texas Instruments Incorporated at www.TI.com.
//   39 **************************************************************************************************/
//   40 
//   41 /*********************************************************************
//   42   This application is designed for the test purpose of the SE profile which
//   43   exploits the following clusters for a Simple Metering configuration:
//   44 
//   45   General Basic
//   46   General Alarms
//   47   General Time
//   48   General Key Establishment
//   49   SE     Simple Metering
//   50 
//   51   Key control:
//   52     SW1:  Join Network
//   53     SW2:  N/A
//   54     SW3:  N/A
//   55     SW4:  N/A
//   56 
//   57 *********************************************************************/
//   58 
//   59 /*********************************************************************
//   60  * INCLUDES
//   61  */
//   62 
//   63 #include "OSAL.h"
//   64 #include "OSAL_Clock.h"
//   65 #include "OSAL_Nv.h"
//   66 #include "ZDApp.h"
//   67 #include "ZDObject.h"
//   68 #include "AddrMgr.h"
//   69 
//   70 #include "se.h"
//   71 #include "simplemeter.h"
//   72 #include "zcl_general.h"
//   73 #include "zcl_se.h"
//   74 #include "zcl_key_establish.h"
//   75 
//   76 #include "onboard.h"
//   77 
//   78 /* HAL */
//   79 #include "hal_lcd.h"
//   80 #include "hal_led.h"
//   81 #include "hal_key.h"
//   82 
//   83 
//   84 /*********************************************************************
//   85  * MACROS
//   86  */
//   87 
//   88 // There is no attribute in the Mandatory Reportable Attribute list for now
//   89 #define zcl_MandatoryReportableAttribute( a ) ( a == NULL )
//   90 
//   91 /*********************************************************************
//   92  * CONSTANTS
//   93  */
//   94 
//   95 #define SIMPLEMETER_MIN_REPORTING_INTERVAL       5
//   96 
//   97 /*********************************************************************
//   98  * TYPEDEFS
//   99  */
//  100 
//  101 /*********************************************************************
//  102  * GLOBAL VARIABLES
//  103  */
//  104 
//  105 /*********************************************************************
//  106  * GLOBAL FUNCTIONS
//  107  */
//  108 
//  109 /*********************************************************************
//  110  * LOCAL VARIABLES
//  111  */
//  112 

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  113 static uint8 simpleMeterTaskID;                                    // osal task id of simple meter
simpleMeterTaskID:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  114 static uint8 simpleMeterTransID;                                   // transaction id
simpleMeterTransID:
        DS 1
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA8
//  115 static afAddrType_t ESPAddr;                                       // esp destination address
ESPAddr:
        DS 12
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA16
//  116 static zclReportCmd_t *pSeReportCmd;                               // report command structure for SE Cluster
pSeReportCmd:
        DS 2
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_Z:XDATA:NOROOT(0)
        DATA16
//  117 static zclReportCmd_t *pBasicReportCmd;                            // report command structure for Basic Cluster
pBasicReportCmd:
        DS 2
        REQUIRE __INIT_XDATA_Z

        RSEG XDATA_I:XDATA:NOROOT(0)
//  118 static uint8 numSeAttr = 5;                                        // number of SE Cluster attributes in report
numSeAttr:
        DATA8
        DS 1
        REQUIRE `?<Initializer for numSeAttr>`
        REQUIRE __INIT_XDATA_I

        RSEG XDATA_I:XDATA:NOROOT(0)
//  119 static uint8 numBasicAttr = 2;                                     // number of Basic Cluster attributes in report
numBasicAttr:
        DATA8
        DS 1
        REQUIRE `?<Initializer for numBasicAttr>`
        REQUIRE __INIT_XDATA_I
//  120 
//  121 // Report attributes defined in simplemeter_data.c
//  122 extern uint8 simpleMeterCurrentSummationDelivered[];
//  123 extern const uint8 simpleMeterZCLVersion;
//  124 extern const uint8 simpleMeterPowerSource;
//  125 extern uint8 simpleMeterStatus;
//  126 extern uint8 simpleMeterUnitOfMeasure;
//  127 extern uint8 simpleMeterSummationFormating;
//  128 extern uint8 simpleMeterDeviceType;
//  129 
//  130 #if SECURE
//  131 static uint8 linkKeyStatus;                                        // status return from get link key routine
//  132 #endif
//  133 
//  134 #if defined ( SE_UK_EXT ) && defined ( SE_MIRROR )
//  135 static afAddrType_t mirrorAddr;
//  136 #endif  // SE_UK_EXT && SE_MIRROR
//  137 
//  138 /*********************************************************************
//  139  * LOCAL FUNCTIONS
//  140  */
//  141 static void simplemeter_HandleKeys( uint8 shift, uint8 keys );
//  142 
//  143 #if SECURE
//  144 static uint8 simplemeter_KeyEstablish_ReturnLinkKey( uint16 shortAddr );
//  145 #endif
//  146 
//  147 static void simplemeter_ProcessIdentifyTimeChange( void );
//  148 
//  149 /*************************************************************************/
//  150 /*** Application Callback Functions                                    ***/
//  151 /*************************************************************************/
//  152 
//  153 // Foundation Callback functions
//  154 static uint8 simplemeter_ValidateAttrDataCB( zclAttrRec_t *pAttr, zclWriteRec_t *pAttrInfo );
//  155 
//  156 // General Cluster Callback functions
//  157 static void simplemeter_BasicResetCB( void );
//  158 static void simplemeter_IdentifyCB( zclIdentify_t *pCmd );
//  159 static void simplemeter_IdentifyQueryRspCB( zclIdentifyQueryRsp_t *pRsp );
//  160 static void simplemeter_AlarmCB( zclAlarm_t *pAlarm );
//  161 #ifdef SE_UK_EXT
//  162 static void simplemeter_GetEventLogCB( uint8 srcEP, afAddrType_t *srcAddr,
//  163                                    zclGetEventLog_t *pEventLog, uint8 seqNum );
//  164 static void simplemeter_PublishEventLogCB( afAddrType_t *srcAddr,
//  165                                              zclPublishEventLog_t *pEventLog );
//  166 #endif // SE_UK_EXT
//  167 
//  168 // Function to process ZDO callback messages
//  169 static void simplemeter_ProcessZDOMsgs( zdoIncomingMsg_t *pMsg );
//  170 
//  171 // SE Callback functions
//  172 static void simplemeter_GetProfileCmdCB( zclCCGetProfileCmd_t *pCmd,
//  173                                          afAddrType_t *srcAddr, uint8 seqNum );
//  174 static void simplemeter_GetProfileRspCB( zclCCGetProfileRsp_t *pCmd,
//  175                                          afAddrType_t *srcAddr, uint8 seqNum );
//  176 static void simplemeter_ReqMirrorRspCB( zclCCReqMirrorRsp_t *pCmd,
//  177                                          afAddrType_t *srcAddr, uint8 seqNum );
//  178 static void simplemeter_MirrorRemRspCB( zclCCMirrorRemRsp_t *pCmd,
//  179                                          afAddrType_t *srcAddr, uint8 seqNum );
//  180 #if defined ( SE_UK_EXT )
//  181 static void simplemeter_GetSnapshotCmdCB( zclCCReqGetSnapshotCmd_t *pCmd,
//  182                                          afAddrType_t *srcAddr, uint8 seqNum );
//  183 static void simplemeter_TakeSnapshotCmdCB( afAddrType_t *srcAddr, uint8 seqNum );
//  184 static void simplemeter_MirrorReportAttrRspCB( zclCCReqMirrorReportAttrRsp_t *pCmd,
//  185                                          afAddrType_t *srcAddr, uint8 seqNum );
//  186 static void simplemeter_PublishTariffInformationCB( zclCCPublishTariffInformation_t *pCmd,
//  187                                          afAddrType_t *srcAddr, uint8 seqNum );
//  188 static void simplemeter_PublishPriceMatrixCB( zclCCPublishPriceMatrix_t *pCmd,
//  189                                          afAddrType_t *srcAddr, uint8 seqNum );
//  190 static void simplemeter_PublishBlockThresholdsCB( zclCCPublishBlockThresholds_t *pCmd,
//  191                                          afAddrType_t *srcAddr, uint8 seqNum );
//  192 static void simplemeter_PublishConversionFactorCB( zclCCPublishConversionFactor_t *pCmd,
//  193                                          afAddrType_t *srcAddr, uint8 seqNum );
//  194 static void simplemeter_PublishCalorificValueCB( zclCCPublishCalorificValue_t *pCmd,
//  195                                          afAddrType_t *srcAddr, uint8 seqNum );
//  196 static void simplemeter_PublishCO2ValueCB( zclCCPublishCO2Value_t *pCmd,
//  197                                          afAddrType_t *srcAddr, uint8 seqNum );
//  198 static void simplemeter_PublishCPPEventCB( zclCCPublishCPPEvent_t *pCmd,
//  199                                          afAddrType_t *srcAddr, uint8 seqNum );
//  200 static void simplemeter_PublishBillingPeriodCB( zclCCPublishBillingPeriod_t *pCmd,
//  201                                          afAddrType_t *srcAddr, uint8 seqNum );
//  202 static void simplemeter_PublishConsolidatedBillCB( zclCCPublishConsolidatedBill_t *pCmd,
//  203                                          afAddrType_t *srcAddr, uint8 seqNum );
//  204 static void simplemeter_PublishCreditPaymentInfoCB( zclCCPublishCreditPaymentInfo_t *pCmd,
//  205                                          afAddrType_t *srcAddr, uint8 seqNum );
//  206 static void simplemeter_ChangeDebtCB( zclCCChangeDebt_t *pCmd,
//  207                                          afAddrType_t *srcAddr, uint8 seqNum );
//  208 static void simplemeter_EmergencyCreditSetupCB( zclCCEmergencyCreditSetup_t *pCmd,
//  209                                          afAddrType_t *srcAddr, uint8 seqNum );
//  210 static void simplemeter_ConsumerTopupCB( zclCCConsumerTopup_t *pCmd,
//  211                                          afAddrType_t *srcAddr, uint8 seqNum );
//  212 static void simplemeter_CreditAdjustmentCB( zclCCCreditAdjustment_t *pCmd,
//  213                                          afAddrType_t *srcAddr, uint8 seqNum );
//  214 static void simplemeter_ChangePaymentModeCB( zclCCChangePaymentMode_t *pCmd,
//  215                                          afAddrType_t *srcAddr, uint8 seqNum );
//  216 static void simplemeter_GetPrepaySnapshotCB( zclCCGetPrepaySnapshot_t *pCmd,
//  217                                          afAddrType_t *srcAddr, uint8 seqNum );
//  218 static void simplemeter_GetTopupLogCB( uint8 numEvents,
//  219                                          afAddrType_t *srcAddr, uint8 seqNum );
//  220 static void simplemeter_SetLowCreditWarningLevelCB( uint8 numEvents,
//  221                                          afAddrType_t *srcAddr, uint8 seqNum );
//  222 static void simplemeter_GetDebtRepaymentLogCB( zclCCGetDebtRepaymentLog_t *pCmd,
//  223                                          afAddrType_t *srcAddr, uint8 seqNum );
//  224 #endif  // SE_UK_EXT
//  225 
//  226 /************************************************************************/
//  227 /***               Functions to process ZCL Foundation                ***/
//  228 /***               incoming Command/Response messages                 ***/
//  229 /************************************************************************/
//  230 static void simplemeter_ProcessZCLMsg( zclIncomingMsg_t *msg );
//  231 #if defined ( ZCL_READ )
//  232 static uint8 simplemeter_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg );
//  233 #endif // ZCL_READ
//  234 #if defined ( ZCL_WRITE )
//  235 static uint8 simplemeter_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg );
//  236 #endif // ZCL_WRITE
//  237 #if defined ( ZCL_REPORT )
//  238 static uint8 simplemeter_ProcessInConfigReportCmd( zclIncomingMsg_t *pInMsg );
//  239 static uint8 simplemeter_ProcessInConfigReportRspCmd( zclIncomingMsg_t *pInMsg );
//  240 static uint8 simplemeter_ProcessInReadReportCfgCmd( zclIncomingMsg_t *pInMsg );
//  241 static uint8 simplemeter_ProcessInReadReportCfgRspCmd( zclIncomingMsg_t *pInMsg );
//  242 static uint8 simplemeter_ProcessInReportCmd( zclIncomingMsg_t *pInMsg );
//  243 #endif // ZCL_REPORT
//  244 static uint8 simplemeter_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg );
//  245 #if defined ( ZCL_DISCOVER )
//  246 static uint8 simplemeter_ProcessInDiscRspCmd( zclIncomingMsg_t *pInMsg );
//  247 #endif // ZCL_DISCOVER
//  248 
//  249 /*********************************************************************
//  250  * ZCL General Clusters Callback table
//  251  */

        RSEG XDATA_I:XDATA:NOROOT(0)
//  252 static zclGeneral_AppCallbacks_t simplemeter_GenCmdCallbacks =
simplemeter_GenCmdCallbacks:
        DATA8
        DS 30
        REQUIRE `?<Initializer for simplemeter_GenCmdCallbacks>`
        REQUIRE __INIT_XDATA_I
//  253 {
//  254   simplemeter_BasicResetCB,              // Basic Cluster Reset command
//  255   simplemeter_IdentifyCB,                // Identify command
//  256   simplemeter_IdentifyQueryRspCB,        // Identify Query Response command
//  257   NULL,                                  // On/Off cluster commands
//  258   NULL,                                  // Level Control Move to Level command
//  259   NULL,                                  // Level Control Move command
//  260   NULL,                                  // Level Control Step command
//  261   NULL,                                  // Level Control Stop command
//  262   NULL,                                  // Group Response commands
//  263   NULL,                                  // Scene Store Request command
//  264   NULL,                                  // Scene Recall Request command
//  265   NULL,                                  // Scene Response command
//  266   simplemeter_AlarmCB,                   // Alarm (Response) command
//  267 #ifdef SE_UK_EXT
//  268   simplemeter_GetEventLogCB,             // Get Event Log command
//  269   simplemeter_PublishEventLogCB,         // Publish Event Log command
//  270 #endif
//  271   NULL,                                  // RSSI Location command
//  272   NULL                                   // RSSI Location Response command
//  273 };
//  274 
//  275 /*********************************************************************
//  276  * ZCL SE Clusters Callback table
//  277  */

        RSEG XDATA_I:XDATA:NOROOT(0)
//  278 static zclSE_AppCallbacks_t simplemeter_SECmdCallbacks =
simplemeter_SECmdCallbacks:
        DATA8
        DS 66
        REQUIRE `?<Initializer for simplemeter_SECmdCallbacks>`
        REQUIRE __INIT_XDATA_I
//  279 {
//  280   NULL,                                               // Publish Price
//  281   NULL,                                               // Publish Block Period
//  282 #if defined ( SE_UK_EXT )
//  283   simplemeter_PublishTariffInformationCB,             // Publish Tariff Information
//  284   simplemeter_PublishPriceMatrixCB,                   // Publish Price Matrix
//  285   simplemeter_PublishBlockThresholdsCB,               // Publish Block Thresholds
//  286   simplemeter_PublishConversionFactorCB,              // Publish Conversion Factor
//  287   simplemeter_PublishCalorificValueCB,                // Publish Calorific Value
//  288   simplemeter_PublishCO2ValueCB,                      // Publish CO2 Value
//  289   simplemeter_PublishCPPEventCB,                      // Publish CPP Event
//  290   simplemeter_PublishBillingPeriodCB,                 // Publish Billing Period
//  291   simplemeter_PublishConsolidatedBillCB,              // Publish Consolidated Bill
//  292   simplemeter_PublishCreditPaymentInfoCB,             // Publish Credit Payment Info
//  293 #endif  // SE_UK_EXT
//  294   NULL,                                               // Get Current Price
//  295   NULL,                                               // Get Scheduled Price
//  296   NULL,                                               // Price Acknowledgement
//  297   NULL,                                               // Get Block Period
//  298 #if defined ( SE_UK_EXT )
//  299   NULL,                                               // Get Tariff Information
//  300   NULL,                                               // Get Price Matrix
//  301   NULL,                                               // Get Block Thresholds
//  302   NULL,                                               // Get Conversion Factor
//  303   NULL,                                               // Get Calorific Value
//  304   NULL,                                               // Get CO2 Value
//  305   NULL,                                               // Get Billing Period
//  306   NULL,                                               // Get Consolidated Bill
//  307   NULL,                                               // CPP Event Response
//  308 #endif  // SE_UK_EXT
//  309   NULL,                                               // Load Control Event
//  310   NULL,                                               // Cancel Load Control Event
//  311   NULL,                                               // Cancel All Load Control Events
//  312   NULL,                                               // Report Event Status
//  313   NULL,                                               // Get Scheduled Event
//  314   simplemeter_GetProfileRspCB,                        // Get Profile Response
//  315   NULL,                                               // Request Mirror Command
//  316   NULL,                                               // Mirror Remove Command
//  317   NULL,                                               // Request Fast Poll Mode Response
//  318 #if defined ( SE_UK_EXT )
//  319   NULL,                                               // Get Snapshot Response
//  320 #endif  // SE_UK_EXT
//  321   simplemeter_GetProfileCmdCB,                        // Get Profile Command
//  322   simplemeter_ReqMirrorRspCB,                         // Request Mirror Response
//  323   simplemeter_MirrorRemRspCB,                         // Mirror Remove Response
//  324   NULL,                                               // Request Fast Poll Mode Command
//  325 #if defined ( SE_UK_EXT )
//  326   simplemeter_GetSnapshotCmdCB,                       // Get Snapshot Command
//  327   simplemeter_TakeSnapshotCmdCB,                      // Take Snapshot Command
//  328   simplemeter_MirrorReportAttrRspCB,                  // Mirror Report Attribute Response
//  329 #endif  // SE_UK_EXT
//  330   NULL,                                               // Display Message Command
//  331   NULL,                                               // Cancel Message Command
//  332   NULL,                                               // Get Last Message Command
//  333   NULL,                                               // Message Confirmation
//  334   NULL,                                               // Request Tunnel Response
//  335   NULL,                                               // Transfer Data
//  336   NULL,                                               // Transfer Data Error
//  337   NULL,                                               // Ack Transfer Data
//  338   NULL,                                               // Ready Data
//  339 #if defined ( SE_UK_EXT )
//  340   NULL,                                               // Supported Tunnel Protocols Response
//  341   NULL,                                               // Tunnel Closure Notification
//  342 #endif  // SE_UK_EXT
//  343   NULL,                                               // Request Tunnel
//  344   NULL,                                               // Close Tunnel
//  345 #if defined ( SE_UK_EXT )
//  346   NULL,                                               // Get Supported Tunnel Protocols
//  347 #endif  // SE_UK_EXT
//  348   NULL,                                               // Supply Status Response
//  349 #if defined ( SE_UK_EXT )
//  350   NULL,                                               // Get Prepay Snapshot Response
//  351   NULL,                                               // Change Payment Mode Response
//  352   NULL,                                               // Consumer Topup Response
//  353   NULL,                                               // Get Commands
//  354   NULL,                                               // Publish Topup Log
//  355   NULL,                                               // Publish Debt Log
//  356 #endif  // SE_UK_EXT
//  357   NULL,                                               // Select Available Emergency Credit Command
//  358   NULL,                                               // Change Supply Command
//  359 #if defined ( SE_UK_EXT )
//  360   simplemeter_ChangeDebtCB,                           // Change Debt
//  361   simplemeter_EmergencyCreditSetupCB,                 // Emergency Credit Setup
//  362   simplemeter_ConsumerTopupCB,                        // Consumer Topup
//  363   simplemeter_CreditAdjustmentCB,                     // Credit Adjustment
//  364   simplemeter_ChangePaymentModeCB,                    // Change PaymentMode
//  365   simplemeter_GetPrepaySnapshotCB,                    // Get Prepay Snapshot
//  366   simplemeter_GetTopupLogCB,                          // Get Topup Log
//  367   simplemeter_SetLowCreditWarningLevelCB,             // Set Low Credit Warning Level
//  368   simplemeter_GetDebtRepaymentLogCB,                  // Get Debt Repayment Log
//  369   NULL,                                               // Publish Calendar
//  370   NULL,                                               // Publish Day Profile
//  371   NULL,                                               // Publish Week Profile
//  372   NULL,                                               // Publish Seasons
//  373   NULL,                                               // Publish Special Days
//  374   NULL,                                               // Get Calendar
//  375   NULL,                                               // Get Day Profiles
//  376   NULL,                                               // Get Week Profiles
//  377   NULL,                                               // Get Seasons
//  378   NULL,                                               // Get Special Days
//  379   NULL,                                               // Publish Change Tenancy
//  380   NULL,                                               // Publish Change Supplier
//  381   NULL,                                               // Change Supply
//  382   NULL,                                               // Change Password
//  383   NULL,                                               // Local Change Supply
//  384   NULL,                                               // Get Change Tenancy
//  385   NULL,                                               // Get Change Supplier
//  386   NULL,                                               // Get Change Supply
//  387   NULL,                                               // Supply Status Response
//  388   NULL,                                               // Get Password
//  389 #endif  // SE_UK_EXT
//  390 };
//  391 
//  392 /*********************************************************************
//  393  * @fn          simplemeter_Init
//  394  *
//  395  * @brief       Initialization function for the ZCL App Application.
//  396  *
//  397  * @param       uint8 task_id - simple meter task id
//  398  *
//  399  * @return      none
//  400  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  401 void simplemeter_Init( uint8 task_id )
simplemeter_Init:
          CFI Block cfiBlock0 Using cfiCommon0
          CFI Function simplemeter_Init
        CODE
//  402 {
        FUNCALL simplemeter_Init, zclSE_Init
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, zclGeneral_RegisterCmdCallbacks
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, zclSE_RegisterCmdCallbacks
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, zcl_registerAttrList
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, zcl_registerClusterOptionList
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, zcl_registerValidateAttrData
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, zcl_registerForMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, RegisterForKeys
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, ZDO_RegisterForZDOMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, osal_start_timerEx
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_Init, ZDOInitDevice
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R1
        MOV     R6,A
//  403   simpleMeterTaskID = task_id;
        MOV     A,R6
        MOV     DPTR,#simpleMeterTaskID
        MOVX    @DPTR,A
//  404   simpleMeterTransID = 0;
        MOV     DPTR,#simpleMeterTransID
        MOV     A,#0x0
        MOVX    @DPTR,A
//  405 
//  406   // Device hardware initialization can be added here or in main() (Zmain.c).
//  407   // If the hardware is application specific - add it here.
//  408   // If the hardware is other parts of the device add it in main().
//  409 
//  410   // ESP destination address init
//  411   ESPAddr.addrMode = (afAddrMode_t)Addr16Bit;
        MOV     DPTR,#ESPAddr + 8
        MOV     A,#0x2
        MOVX    @DPTR,A
//  412   ESPAddr.endPoint = SIMPLEMETER_ENDPOINT;
        MOV     DPTR,#ESPAddr + 9
        MOV     A,#0x9
        MOVX    @DPTR,A
//  413   ESPAddr.addr.shortAddr = 0;
        MOV     DPTR,#ESPAddr
        MOV     A,#0x0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
//  414 
//  415   // register for SE endpoint
//  416   zclSE_Init( &simpleMeterSimpleDesc );
        ; Setup parameters for call to function zclSE_Init
        MOV     R2,#simpleMeterSimpleDesc & 0xff
        MOV     R3,#(simpleMeterSimpleDesc >> 8) & 0xff
        LCALL   ??zclSE_Init?relay
//  417 
//  418   // Register the ZCL General Cluster Library callback functions
//  419   zclGeneral_RegisterCmdCallbacks( SIMPLEMETER_ENDPOINT, &simplemeter_GenCmdCallbacks );
        ; Setup parameters for call to function zclGeneral_RegisterCmdCallbacks
        MOV     R2,#simplemeter_GenCmdCallbacks & 0xff
        MOV     R3,#(simplemeter_GenCmdCallbacks >> 8) & 0xff
        MOV     R1,#0x9
        LCALL   ??zclGeneral_RegisterCmdCallbacks?relay
        MOV     A,R1
//  420 
//  421   // Register the ZCL SE Cluster Library callback functions
//  422   zclSE_RegisterCmdCallbacks( SIMPLEMETER_ENDPOINT, &simplemeter_SECmdCallbacks );
        ; Setup parameters for call to function zclSE_RegisterCmdCallbacks
        MOV     R2,#simplemeter_SECmdCallbacks & 0xff
        MOV     R3,#(simplemeter_SECmdCallbacks >> 8) & 0xff
        MOV     R1,#0x9
        LCALL   ??zclSE_RegisterCmdCallbacks?relay
        MOV     A,R1
//  423 
//  424   // Register the application's attribute list
//  425   zcl_registerAttrList( SIMPLEMETER_ENDPOINT, SIMPLEMETER_MAX_ATTRIBUTES, simpleMeterAttrs );
        ; Setup parameters for call to function zcl_registerAttrList
        MOV     R4,#simpleMeterAttrs & 0xff
        MOV     R5,#(simpleMeterAttrs >> 8) & 0xff
        MOV     R2,#0x37
        MOV     R1,#0x9
        LCALL   ??zcl_registerAttrList?relay
        MOV     A,R1
//  426 
//  427   // Register the application's cluster option list
//  428   zcl_registerClusterOptionList( SIMPLEMETER_ENDPOINT, SIMPLEMETER_MAX_OPTIONS, simpleMeterOptions );
        ; Setup parameters for call to function zcl_registerClusterOptionList
        MOV     R4,#simpleMeterOptions & 0xff
        MOV     R5,#(simpleMeterOptions >> 8) & 0xff
        MOV     R2,#0x2
        MOV     R1,#0x9
        LCALL   ??zcl_registerClusterOptionList?relay
        MOV     A,R1
//  429 
//  430   // Register the application's attribute data validation callback function
//  431   zcl_registerValidateAttrData( simplemeter_ValidateAttrDataCB );
        ; Setup parameters for call to function zcl_registerValidateAttrData
        MOV     R2,#??simplemeter_ValidateAttrDataCB?relay & 0xff
        MOV     R3,#(??simplemeter_ValidateAttrDataCB?relay >> 8) & 0xff
        LCALL   ??zcl_registerValidateAttrData?relay
        MOV     A,R1
//  432 
//  433   // Register the Application to receive the unprocessed Foundation command/response messages
//  434   zcl_registerForMsg( simpleMeterTaskID );
        ; Setup parameters for call to function zcl_registerForMsg
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??zcl_registerForMsg?relay
        MOV     A,R1
//  435 
//  436   // Register for all key events - This app will handle all key events
//  437   RegisterForKeys( simpleMeterTaskID );
        ; Setup parameters for call to function RegisterForKeys
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??RegisterForKeys?relay
        MOV     A,R1
//  438 
//  439   // Register with the ZDO to receive Match Descriptor Responses
//  440   ZDO_RegisterForZDOMsg(task_id, Match_Desc_rsp);
        ; Setup parameters for call to function ZDO_RegisterForZDOMsg
        MOV     R2,#0x6
        MOV     R3,#-0x80
        MOV     A,R6
        MOV     R1,A
        LCALL   ??ZDO_RegisterForZDOMsg?relay
        MOV     A,R1
//  441 
//  442   // Start the timer to sync SimpleMeter timer with the osal timer
//  443   osal_start_timerEx( simpleMeterTaskID, SIMPLEMETER_UPDATE_TIME_EVT, SIMPLEMETER_UPDATE_TIME_PERIOD );
        ; Setup parameters for call to function osal_start_timerEx
        MOV     R4,#-0x18
        MOV     R5,#0x3
        MOV     R2,#0x2
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_start_timerEx?relay
        MOV     A,R1
//  444 
//  445   // setup attribute IDs of interest for Simple Meter
//  446   pBasicReportCmd = (zclReportCmd_t *)osal_mem_alloc( sizeof( zclReportCmd_t ) + ( numBasicAttr * sizeof( zclReport_t ) ) );
        ; Setup parameters for call to function osal_mem_alloc
        MOV     DPTR,#numBasicAttr
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x5
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x5
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,R0
        ADD     A,#0x1
        MOV     R2,A
        MOV     A,R1
        ADDC    A,#0x0
        MOV     R3,A
        LCALL   ??osal_mem_alloc?relay
        MOV     DPTR,#pBasicReportCmd
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  447   if ( pBasicReportCmd != NULL )
        MOV     DPTR,#pBasicReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        ORL     A,R1
        JNZ     $+5
        LJMP    ??simplemeter_Init_0 & 0xFFFF
//  448   {
//  449     pBasicReportCmd->numAttr = numBasicAttr;
        MOV     DPTR,#numBasicAttr
        MOVX    A,@DPTR
        PUSH    A
          CFI CFA_SP SP+-1
        MOV     DPTR,#pBasicReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        POP     A
          CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  450 
//  451     pBasicReportCmd->attrList[0].attrID = ATTRID_BASIC_ZCL_VERSION;
        MOV     DPTR,#pBasicReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
//  452     pBasicReportCmd->attrList[0].dataType = ZCL_DATATYPE_UINT8;
        MOV     DPTR,#pBasicReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOV     A,#0x20
        MOVX    @DPTR,A
//  453     pBasicReportCmd->attrList[0].attrData = (uint8*) &simpleMeterZCLVersion;
        MOV     DPTR,#pBasicReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOV     A,#simpleMeterZCLVersion & 0xff
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#(simpleMeterZCLVersion >> 8) & 0xff
        MOVX    @DPTR,A
//  454 
//  455     pBasicReportCmd->attrList[1].attrID = ATTRID_BASIC_POWER_SOURCE;
        MOV     DPTR,#pBasicReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x6
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x7
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
//  456     pBasicReportCmd->attrList[1].dataType = ZCL_DATATYPE_ENUM8;
        MOV     DPTR,#pBasicReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x8
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x30
        MOVX    @DPTR,A
//  457     pBasicReportCmd->attrList[1].attrData = (uint8*) &simpleMeterPowerSource;
        MOV     DPTR,#pBasicReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x9
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#simpleMeterPowerSource & 0xff
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#(simpleMeterPowerSource >> 8) & 0xff
        MOVX    @DPTR,A
//  458   }
//  459 
//  460   pSeReportCmd = (zclReportCmd_t *)osal_mem_alloc( sizeof( zclReportCmd_t ) + ( numSeAttr * sizeof( zclReport_t ) ) );
??simplemeter_Init_0:
        ; Setup parameters for call to function osal_mem_alloc
        MOV     DPTR,#numSeAttr
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x5
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x5
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,R0
        ADD     A,#0x1
        MOV     R2,A
        MOV     A,R1
        ADDC    A,#0x0
        MOV     R3,A
        LCALL   ??osal_mem_alloc?relay
        MOV     DPTR,#pSeReportCmd
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
//  461   if ( pSeReportCmd != NULL )
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        ORL     A,R1
        JNZ     $+5
        LJMP    ??simplemeter_Init_1 & 0xFFFF
//  462   {
//  463     pSeReportCmd->numAttr = numSeAttr;
        MOV     DPTR,#numSeAttr
        MOVX    A,@DPTR
        PUSH    A
          CFI CFA_SP SP+-1
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        POP     A
          CFI CFA_SP SP+0
        MOVX    @DPTR,A
//  464 
//  465     // Set up the first attribute
//  466     pSeReportCmd->attrList[0].attrID = ATTRID_SE_CURRENT_SUMMATION_DELIVERED;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
//  467     pSeReportCmd->attrList[0].dataType = ZCL_DATATYPE_UINT48;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOV     A,#0x25
        MOVX    @DPTR,A
//  468     pSeReportCmd->attrList[0].attrData = simpleMeterCurrentSummationDelivered;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOV     A,#simpleMeterCurrentSummationDelivered & 0xff
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#(simpleMeterCurrentSummationDelivered >> 8) & 0xff
        MOVX    @DPTR,A
//  469 
//  470     pSeReportCmd->attrList[1].attrID = ATTRID_SE_STATUS;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x6
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x2
        MOVX    @DPTR,A
//  471     pSeReportCmd->attrList[1].dataType = ZCL_DATATYPE_BITMAP8;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x8
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x18
        MOVX    @DPTR,A
//  472     pSeReportCmd->attrList[1].attrData = &simpleMeterStatus;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x9
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#simpleMeterStatus & 0xff
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#(simpleMeterStatus >> 8) & 0xff
        MOVX    @DPTR,A
//  473 
//  474     pSeReportCmd->attrList[2].attrID = ATTRID_SE_UNIT_OF_MEASURE;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0xb
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x3
        MOVX    @DPTR,A
//  475     pSeReportCmd->attrList[2].dataType = ZCL_DATATYPE_ENUM8;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0xd
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x30
        MOVX    @DPTR,A
//  476     pSeReportCmd->attrList[2].attrData = &simpleMeterUnitOfMeasure;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0xe
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#simpleMeterUnitOfMeasure & 0xff
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#(simpleMeterUnitOfMeasure >> 8) & 0xff
        MOVX    @DPTR,A
//  477 
//  478     pSeReportCmd->attrList[3].attrID = ATTRID_SE_SUMMATION_FORMATTING;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x10
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x3
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x3
        MOVX    @DPTR,A
//  479     pSeReportCmd->attrList[3].dataType = ZCL_DATATYPE_BITMAP8;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x12
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x18
        MOVX    @DPTR,A
//  480     pSeReportCmd->attrList[3].attrData = &simpleMeterSummationFormating;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x13
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#simpleMeterSummationFormating & 0xff
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#(simpleMeterSummationFormating >> 8) & 0xff
        MOVX    @DPTR,A
//  481 
//  482     pSeReportCmd->attrList[4].attrID = ATTRID_SE_METERING_DEVICE_TYPE;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x15
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x6
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x3
        MOVX    @DPTR,A
//  483     pSeReportCmd->attrList[4].dataType = ZCL_DATATYPE_BITMAP8;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x18
        MOVX    @DPTR,A
//  484     pSeReportCmd->attrList[4].attrData = &simpleMeterDeviceType;
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0x18
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#simpleMeterDeviceType & 0xff
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#(simpleMeterDeviceType >> 8) & 0xff
        MOVX    @DPTR,A
//  485 
//  486     // Set up additional attributes
//  487   }
//  488   ZDOInitDevice(0);  // Join the network.
??simplemeter_Init_1:
        ; Setup parameters for call to function ZDOInitDevice
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??ZDOInitDevice?relay
        MOV     A,R1
//  489 }
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock0
//  490 
//  491 /*********************************************************************
//  492  * @fn          simplemeter_event_loop
//  493  *
//  494  * @brief       Event Loop Processor for the simple meter.
//  495  *
//  496  * @param       uint8 task_id - the osal task id
//  497  * @param       uint16 events - the event bitmask
//  498  *
//  499  * @return      none
//  500  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  501 uint16 simplemeter_event_loop( uint8 task_id, uint16 events )
simplemeter_event_loop:
          CFI Block cfiBlock1 Using cfiCommon0
          CFI Function simplemeter_event_loop
        CODE
//  502 {
        FUNCALL simplemeter_event_loop, osal_msg_receive
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, simplemeter_ProcessZDOMsgs
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, simplemeter_ProcessZCLMsg
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, simplemeter_HandleKeys
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, osal_set_event
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, NLME_SetPollRate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, osal_set_event
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, osal_msg_deallocate
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, zclGeneral_KeyEstablish_InitiateKeyEstablishment
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, osal_start_timerEx
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, zcl_SendReportCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 19, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 19, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, osal_start_timerEx
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, simplemeter_ProcessIdentifyTimeChange
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, osal_getClock
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_event_loop, osal_start_timerEx
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 14, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 14, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xe
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 0
        MOV     ?V0 + 2,R1
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  503   afIncomingMSGPacket_t *MSGpkt;
//  504 
//  505   if ( events & SYS_EVENT_MSG )
        MOV     A,R6
        ANL     A,#0x0
        MOV     R0,A
        MOV     A,R7
        ANL     A,#0x80
        MOV     R1,A
        MOV     A,R0
        ORL     A,R1
        JNZ     $+5
        LJMP    ??simplemeter_event_loop_0 & 0xFFFF
//  506   {
//  507     while ( (MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( simpleMeterTaskID )) )
??simplemeter_event_loop_1:
        ; Setup parameters for call to function osal_msg_receive
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_msg_receive?relay
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
        MOV     R0,?V0 + 4
        MOV     R1,?V0 + 5
        MOV     ?V0 + 0,R0
        MOV     ?V0 + 1,R1
        MOV     A,R0
        ORL     A,R1
        JNZ     $+5
        LJMP    ??simplemeter_event_loop_2 & 0xFFFF
//  508     {
//  509       switch ( MSGpkt->hdr.event )
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    A,@DPTR
        ADD     A,#-0x34
        JZ      ??simplemeter_event_loop_3
        DEC     A
        JZ      ??simplemeter_event_loop_4
        ADD     A,#0x75
        JZ      ??simplemeter_event_loop_5
        ADD     A,#-0x11
        JZ      ??simplemeter_event_loop_6
        ADD     A,#-0x2
        JNZ     ??simplemeter_event_loop_7
//  510       {
//  511         case ZDO_CB_MSG:
//  512           simplemeter_ProcessZDOMsgs( (zdoIncomingMsg_t *)MSGpkt );
        ; Setup parameters for call to function simplemeter_ProcessZDOMsgs
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??simplemeter_ProcessZDOMsgs?relay
//  513           break;
        SJMP    ??simplemeter_event_loop_7
//  514 
//  515         case ZCL_INCOMING_MSG:
//  516           // Incoming ZCL foundation command/response messages
//  517           simplemeter_ProcessZCLMsg( (zclIncomingMsg_t *)MSGpkt );
??simplemeter_event_loop_3:
        ; Setup parameters for call to function simplemeter_ProcessZCLMsg
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??simplemeter_ProcessZCLMsg?relay
//  518           break;
        SJMP    ??simplemeter_event_loop_7
//  519 
//  520         case KEY_CHANGE:
//  521           simplemeter_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
??simplemeter_event_loop_5:
        ; Setup parameters for call to function simplemeter_HandleKeys
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??simplemeter_HandleKeys?relay
//  522           break;
        SJMP    ??simplemeter_event_loop_7
//  523 
//  524         case ZDO_STATE_CHANGE:
//  525           if ((DEV_END_DEVICE == (devStates_t)(MSGpkt->hdr.status)) ||
//  526               (DEV_ROUTER == (devStates_t)(MSGpkt->hdr.status)))
??simplemeter_event_loop_6:
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x6
        JZ      ??simplemeter_event_loop_8
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x7
        JNZ     ??simplemeter_event_loop_7
//  527           {
//  528 #if SECURE
//  529             {
//  530               // check to see if link key had already been established
//  531               linkKeyStatus = simplemeter_KeyEstablish_ReturnLinkKey(ESPAddr.addr.shortAddr);
//  532 
//  533               if (linkKeyStatus != ZSuccess)
//  534               {
//  535                 cId_t cbkeCluster = ZCL_CLUSTER_ID_GEN_KEY_ESTABLISHMENT;
//  536                 zAddrType_t dstAddr;
//  537 
//  538                 // Send out a match for the key establishment
//  539                 dstAddr.addrMode = AddrBroadcast;
//  540                 dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR;
//  541                 ZDP_MatchDescReq( &dstAddr, NWK_BROADCAST_SHORTADDR, ZCL_SE_PROFILE_ID,
//  542                                   1, &cbkeCluster, 0, NULL, FALSE );
//  543               }
//  544               else
//  545               {
//  546                 // link key already established, resume sending reports
//  547                 osal_set_event( simpleMeterTaskID, SIMPLEMETER_CONNECTED_EVT );
//  548               }
//  549             }
//  550 #else
//  551             {
//  552               osal_set_event( simpleMeterTaskID, SIMPLEMETER_CONNECTED_EVT );
??simplemeter_event_loop_8:
        ; Setup parameters for call to function osal_set_event
        MOV     R2,#0x10
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_set_event?relay
        MOV     A,R1
//  553             }
//  554 #endif
//  555             // per smart energy spec end device polling requirement of not to poll < 7.5 seconds
//  556             NLME_SetPollRate ( SE_DEVICE_POLL_RATE );
        ; Setup parameters for call to function NLME_SetPollRate
        MOV     R2,#0x40
        MOV     R3,#0x1f
        LCALL   ??NLME_SetPollRate?relay
//  557           }
//  558           break;
        SJMP    ??simplemeter_event_loop_7
//  559 
//  560 #if defined( ZCL_KEY_ESTABLISH )
//  561         case ZCL_KEY_ESTABLISH_IND:
//  562           if ((MSGpkt->hdr.status) == TermKeyStatus_Success)
??simplemeter_event_loop_4:
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOVX    A,@DPTR
        JNZ     ??simplemeter_event_loop_7
//  563           {
//  564             ESPAddr.endPoint = SIMPLEMETER_ENDPOINT; // set destination endpoint back to application endpoint
        MOV     DPTR,#ESPAddr + 9
        MOV     A,#0x9
        MOVX    @DPTR,A
//  565             osal_set_event( simpleMeterTaskID, SIMPLEMETER_CONNECTED_EVT );
        ; Setup parameters for call to function osal_set_event
        MOV     R2,#0x10
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_set_event?relay
        MOV     A,R1
//  566           }
//  567           break;
//  568 #endif
//  569 
//  570         default:
//  571           break;
//  572       }
//  573 
//  574       // Release the memory
//  575       osal_msg_deallocate( (uint8 *)MSGpkt );
??simplemeter_event_loop_7:
        ; Setup parameters for call to function osal_msg_deallocate
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??osal_msg_deallocate?relay
        MOV     A,R1
        LJMP    ??simplemeter_event_loop_1 & 0xFFFF
//  576     }
//  577 
//  578     // return unprocessed events
//  579     return (events ^ SYS_EVENT_MSG);
??simplemeter_event_loop_2:
        MOV     A,R6
        XRL     A,#0x0
        MOV     R2,A
        MOV     A,R7
        XRL     A,#0x80
        MOV     R3,A
        LJMP    ??simplemeter_event_loop_9 & 0xFFFF
//  580   }
//  581 
//  582   // event to intiate key establishment request
//  583   if ( events & SIMPLEMETER_KEY_ESTABLISHMENT_REQUEST_EVT )
??simplemeter_event_loop_0:
        MOV     A,R6
        ANL     A,#0x4
        JZ      ??simplemeter_event_loop_10
//  584   {
//  585     zclGeneral_KeyEstablish_InitiateKeyEstablishment(simpleMeterTaskID, &ESPAddr, simpleMeterTransID);
        ; Setup parameters for call to function zclGeneral_KeyEstablish_InitiateKeyEstablishment
        MOV     DPTR,#simpleMeterTransID
        MOVX    A,@DPTR
        MOV     R4,A
        MOV     R2,#ESPAddr & 0xff
        MOV     R3,#(ESPAddr >> 8) & 0xff
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??zclGeneral_KeyEstablish_InitiateKeyEstablishm
        MOV     A,R1
//  586 
//  587     return ( events ^ SIMPLEMETER_KEY_ESTABLISHMENT_REQUEST_EVT );
        MOV     A,R6
        XRL     A,#0x4
        MOV     R2,A
        MOV     A,R7
        XRL     A,#0x0
        MOV     R3,A
        LJMP    ??simplemeter_event_loop_9 & 0xFFFF
//  588   }
//  589 
//  590   // Event indicating the meter has connected, and the security process has completed
//  591   if ( events & SIMPLEMETER_CONNECTED_EVT )
??simplemeter_event_loop_10:
        MOV     A,R6
        ANL     A,#0x10
        JZ      ??simplemeter_event_loop_11
//  592   {
//  593 #if defined ( SE_UK_EXT ) && defined ( SE_MIRROR )
//  594     // Request a mirror on the ESP
//  595     zclSE_SimpleMetering_Send_ReqMirrorCmd(SIMPLEMETER_ENDPOINT, &ESPAddr, TRUE, 0);
//  596 #endif  // SE_UK_EXT && SE_MIRROR
//  597 
//  598     // Start Reporting attributes
//  599     osal_start_timerEx( simpleMeterTaskID, SIMPLEMETER_REPORT_ATTRIBUTE_EVT, SIMPLEMETER_REPORT_PERIOD );
        ; Setup parameters for call to function osal_start_timerEx
        MOV     R4,#-0x78
        MOV     R5,#0x13
        MOV     R2,#0x8
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_start_timerEx?relay
        MOV     A,R1
//  600 
//  601     return ( events ^ SIMPLEMETER_CONNECTED_EVT );
        MOV     A,R6
        XRL     A,#0x10
        MOV     R2,A
        MOV     A,R7
        XRL     A,#0x0
        MOV     R3,A
        LJMP    ??simplemeter_event_loop_9 & 0xFFFF
//  602   }
//  603 
//  604   // event to send report attribute
//  605   if ( events & SIMPLEMETER_REPORT_ATTRIBUTE_EVT )
??simplemeter_event_loop_11:
        MOV     A,R6
        ANL     A,#0x8
        JZ      ??simplemeter_event_loop_12
//  606   {
//  607     if ( pSeReportCmd != NULL )
        MOV     DPTR,#pSeReportCmd
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        ORL     A,R1
        JZ      ??simplemeter_event_loop_13
//  608     {
//  609       zcl_SendReportCmd( SIMPLEMETER_ENDPOINT, &ESPAddr,
//  610                          ZCL_CLUSTER_ID_SE_SIMPLE_METERING, pSeReportCmd,
//  611                          ZCL_FRAME_SERVER_CLIENT_DIR, 1, 0 );
        ; Setup parameters for call to function zcl_SendReportCmd
        MOV     ?V0 + 3,#0x0
        MOV     R0,#?V0 + 3
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 15)
        MOV     ?V0 + 3,#0x1
        MOV     R0,#?V0 + 3
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 16)
        MOV     ?V0 + 3,#0x1
        MOV     R0,#?V0 + 3
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 17)
        MOV     DPTR,#pSeReportCmd
        LCALL   ?PUSH_XSTACK8_X_TWO
          CFI CFA_XSP16 add(XSP16, 19)
        MOV     R4,#0x2
        MOV     R5,#0x7
        MOV     R2,#ESPAddr & 0xff
        MOV     R3,#(ESPAddr >> 8) & 0xff
        MOV     R1,#0x9
        LCALL   ??zcl_SendReportCmd?relay
        MOV     A,#0x5
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     A,R1
//  612 
//  613       osal_start_timerEx( simpleMeterTaskID, SIMPLEMETER_REPORT_ATTRIBUTE_EVT, SIMPLEMETER_REPORT_PERIOD );
        ; Setup parameters for call to function osal_start_timerEx
        MOV     R4,#-0x78
        MOV     R5,#0x13
        MOV     R2,#0x8
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_start_timerEx?relay
        MOV     A,R1
//  614     }
//  615 
//  616     return ( events ^ SIMPLEMETER_REPORT_ATTRIBUTE_EVT );
??simplemeter_event_loop_13:
        MOV     A,R6
        XRL     A,#0x8
        MOV     R2,A
        MOV     A,R7
        XRL     A,#0x0
        MOV     R3,A
        SJMP    ??simplemeter_event_loop_9
//  617   }
//  618 
//  619   // handle processing of identify timeout event triggered by an identify command
//  620   if ( events & SIMPLEMETER_IDENTIFY_TIMEOUT_EVT )
??simplemeter_event_loop_12:
        MOV     A,R6
        MOV     C,0xE0 /* A   */.0
        JNC     ??simplemeter_event_loop_14
//  621   {
//  622     if ( simpleMeterIdentifyTime > 0 )
        MOV     DPTR,#simpleMeterIdentifyTime
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        ORL     A,R1
        JZ      ??simplemeter_event_loop_15
//  623     {
//  624       simpleMeterIdentifyTime--;
        MOV     DPTR,#simpleMeterIdentifyTime
        MOVX    A,@DPTR
        ADD     A,#-0x1
        MOVX    @DPTR,A
        INC     DPTR
        MOVX    A,@DPTR
        ADDC    A,#-0x1
        MOVX    @DPTR,A
//  625     }
//  626     simplemeter_ProcessIdentifyTimeChange();
??simplemeter_event_loop_15:
        ; Setup parameters for call to function simplemeter_ProcessIdentifyTimeChange
        LCALL   ??simplemeter_ProcessIdentifyTimeChange?relay
//  627 
//  628     return ( events ^ SIMPLEMETER_IDENTIFY_TIMEOUT_EVT );
        MOV     A,R6
        XRL     A,#0x1
        MOV     R2,A
        MOV     A,R7
        XRL     A,#0x0
        MOV     R3,A
        SJMP    ??simplemeter_event_loop_9
//  629   }
//  630 
//  631   // event to get current time
//  632   if ( events & SIMPLEMETER_UPDATE_TIME_EVT )
??simplemeter_event_loop_14:
        MOV     A,R6
        ANL     A,#0x2
        JZ      ??simplemeter_event_loop_16
//  633   {
//  634     simpleMeterTime = osal_getClock();
        ; Setup parameters for call to function osal_getClock
        LCALL   ??osal_getClock?relay
        MOV     DPTR,#simpleMeterTime
        LCALL   ?XSTORE_R2345
//  635     osal_start_timerEx( simpleMeterTaskID, SIMPLEMETER_UPDATE_TIME_EVT, SIMPLEMETER_UPDATE_TIME_PERIOD );
        ; Setup parameters for call to function osal_start_timerEx
        MOV     R4,#-0x18
        MOV     R5,#0x3
        MOV     R2,#0x2
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_start_timerEx?relay
        MOV     A,R1
//  636 
//  637     return ( events ^ SIMPLEMETER_UPDATE_TIME_EVT );
        MOV     A,R6
        XRL     A,#0x2
        MOV     R2,A
        MOV     A,R7
        XRL     A,#0x0
        MOV     R3,A
        SJMP    ??simplemeter_event_loop_9
//  638   }
//  639 
//  640   // Discard unknown events
//  641   return 0;
??simplemeter_event_loop_16:
        MOV     R2,#0x0
        MOV     R3,#0x0
??simplemeter_event_loop_9:
        MOV     R7,#0x6
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock1
//  642 }
//  643 
//  644 /*********************************************************************
//  645  * @fn      simplemeter_ProcessZDOMsgs
//  646  *
//  647  * @brief   Called to process callbacks from the ZDO.
//  648  *
//  649  * @param   none
//  650  *
//  651  * @return  none
//  652  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  653 static void simplemeter_ProcessZDOMsgs( zdoIncomingMsg_t *pMsg )
simplemeter_ProcessZDOMsgs:
          CFI Block cfiBlock2 Using cfiCommon0
          CFI Function simplemeter_ProcessZDOMsgs
        CODE
//  654 {
        FUNCALL simplemeter_ProcessZDOMsgs, ZDO_ParseEPListRsp
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZDOMsgs, osal_set_event
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZDOMsgs, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 12, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 12, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xc
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 12)
        ; Saved register size: 12
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  655   if (pMsg->clusterID == Match_Desc_rsp)
        MOV     A,R6
        ADD     A,#0xc
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        XRL     A,#0x6
        JNZ     ??simplemeter_ProcessZDOMsgs_0
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x80
??simplemeter_ProcessZDOMsgs_0:
        JNZ     ??simplemeter_ProcessZDOMsgs_1
//  656   {
//  657     ZDO_ActiveEndpointRsp_t *pRsp = ZDO_ParseEPListRsp( pMsg );
        ; Setup parameters for call to function ZDO_ParseEPListRsp
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??ZDO_ParseEPListRsp?relay
        MOV     ?V0 + 2,R2
        MOV     ?V0 + 3,R3
        MOV     ?V0 + 0,?V0 + 2
        MOV     ?V0 + 1,?V0 + 3
//  658 
//  659     if (pRsp)
        MOV     A,?V0 + 0
        ORL     A,?V0 + 1
        JZ      ??simplemeter_ProcessZDOMsgs_1
//  660     {
//  661       if (pRsp->cnt)
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        JZ      ??simplemeter_ProcessZDOMsgs_2
//  662       {
//  663         // Record the trust center
//  664         ESPAddr.endPoint = pRsp->epList[0];
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPTR,#ESPAddr + 9
        MOVX    @DPTR,A
//  665         ESPAddr.addr.shortAddr = pMsg->srcAddr.addr.shortAddr;
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     DPTR,#ESPAddr
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
//  666 
//  667         // send out key establishment request
//  668         osal_set_event( simpleMeterTaskID, SIMPLEMETER_KEY_ESTABLISHMENT_REQUEST_EVT);
        ; Setup parameters for call to function osal_set_event
        MOV     R2,#0x4
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_set_event?relay
        MOV     A,R1
//  669       }
//  670       osal_mem_free(pRsp);
??simplemeter_ProcessZDOMsgs_2:
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 0
        MOV     R3,?V0 + 1
        LCALL   ??osal_mem_free?relay
//  671     }
//  672   }
//  673 }
??simplemeter_ProcessZDOMsgs_1:
        MOV     R7,#0x4
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock2
//  674 
//  675 /*********************************************************************
//  676  * @fn      simplemeter_ProcessIdentifyTimeChange
//  677  *
//  678  * @brief   Called to blink led for specified IdentifyTime attribute value
//  679  *
//  680  * @param   none
//  681  *
//  682  * @return  none
//  683  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  684 static void simplemeter_ProcessIdentifyTimeChange( void )
simplemeter_ProcessIdentifyTimeChange:
          CFI Block cfiBlock3 Using cfiCommon0
          CFI Function simplemeter_ProcessIdentifyTimeChange
        CODE
//  685 {
        FUNCALL simplemeter_ProcessIdentifyTimeChange, osal_start_timerEx
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessIdentifyTimeChange, HalLedBlink
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessIdentifyTimeChange, HalLedSet
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessIdentifyTimeChange, osal_stop_timerEx
        LOCFRAME ISTACK, 2, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 0, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 2, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 0, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//  686   if ( simpleMeterIdentifyTime > 0 )
        MOV     DPTR,#simpleMeterIdentifyTime
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        ORL     A,R1
        JZ      ??simplemeter_ProcessIdentifyTimeChange_0
//  687   {
//  688     osal_start_timerEx( simpleMeterTaskID, SIMPLEMETER_IDENTIFY_TIMEOUT_EVT, 1000 );
        ; Setup parameters for call to function osal_start_timerEx
        MOV     R4,#-0x18
        MOV     R5,#0x3
        MOV     R2,#0x1
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_start_timerEx?relay
        MOV     A,R1
//  689     HalLedBlink ( HAL_LED_4, 0xFF, HAL_LED_DEFAULT_DUTY_CYCLE, HAL_LED_DEFAULT_FLASH_TIME );
        ; Setup parameters for call to function HalLedBlink
        MOV     R4,#-0x18
        MOV     R5,#0x3
        MOV     R3,#0x5
        MOV     R2,#-0x1
        MOV     R1,#0x8
        LCALL   ??HalLedBlink?relay
        SJMP    ??simplemeter_ProcessIdentifyTimeChange_1
//  690   }
//  691   else
//  692   {
//  693     HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF );
??simplemeter_ProcessIdentifyTimeChange_0:
        ; Setup parameters for call to function HalLedSet
        MOV     R2,#0x0
        MOV     R1,#0x8
        LCALL   ??HalLedSet?relay
        MOV     A,R1
//  694     osal_stop_timerEx( simpleMeterTaskID, SIMPLEMETER_IDENTIFY_TIMEOUT_EVT );
        ; Setup parameters for call to function osal_stop_timerEx
        MOV     R2,#0x1
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_stop_timerEx?relay
        MOV     A,R1
//  695   }
//  696 }
??simplemeter_ProcessIdentifyTimeChange_1:
        POP     DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP     DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP    ?BRET
          CFI EndBlock cfiBlock3
//  697 
//  698 #if SECURE
//  699 /*********************************************************************
//  700  * @fn      simplemeter_KeyEstablish_ReturnLinkKey
//  701  *
//  702  * @brief   This function get the requested link key
//  703  *
//  704  * @param   shortAddr - short address of the partner.
//  705  *
//  706  * @return  none
//  707  */
//  708 static uint8 simplemeter_KeyEstablish_ReturnLinkKey( uint16 shortAddr )
//  709 {
//  710   uint8 status = ZFailure;
//  711   AddrMgrEntry_t entry;
//  712 
//  713   // Look up the long address of the device
//  714 
//  715   entry.user = ADDRMGR_USER_DEFAULT;
//  716   entry.nwkAddr = shortAddr;
//  717 
//  718   if ( AddrMgrEntryLookupNwk( &entry ) )
//  719   {
//  720     // check if APS link key has been established
//  721     if ( APSME_IsLinkKeyValid( entry.extAddr ) == TRUE )
//  722     {
//  723       status = ZSuccess;
//  724     }
//  725   }
//  726   else
//  727   {
//  728     // It's an unknown device
//  729     status = ZInvalidParameter;
//  730   }
//  731 
//  732   return status;
//  733 }
//  734 #endif
//  735 
//  736 /*********************************************************************
//  737  * @fn      simplemeter_HandleKeys
//  738  *
//  739  * @brief   Handles all key events for this device.
//  740  *
//  741  * @param   shift - true if in shift/alt.
//  742  * @param   keys - bit field for key events. Valid entries:
//  743  *                 HAL_KEY_SW_4
//  744  *                 HAL_KEY_SW_3
//  745  *                 HAL_KEY_SW_2
//  746  *                 HAL_KEY_SW_1
//  747  *
//  748  * @return  none
//  749  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  750 static void simplemeter_HandleKeys( uint8 shift, uint8 keys )
simplemeter_HandleKeys:
          CFI Block cfiBlock4 Using cfiCommon0
          CFI Function simplemeter_HandleKeys
        CODE
//  751 {
        FUNCALL simplemeter_HandleKeys, ZDOInitDevice
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_HandleKeys, zcl_SendCommand
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 21, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 21, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_HandleKeys, ZDOInitDevice
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 10, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 10, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
        MOV     A,R1
        MOV     R6,A
        MOV     A,R2
        MOV     R7,A
//  752   // Shift is used to make each button/switch dual purpose.
//  753   if ( shift )
        MOV     A,R6
        JZ      ??simplemeter_HandleKeys_0
//  754   {
//  755     if ( keys & HAL_KEY_SW_1 )
        MOV     A,R7
        MOV     C,0xE0 /* A   */.0
        JNC     ??simplemeter_HandleKeys_1
//  756     {
//  757       asm("NOP");
        NOP
//  758     }
//  759     if ( keys & HAL_KEY_SW_2 )
??simplemeter_HandleKeys_1:
        MOV     A,R7
        MOV     C,0xE0 /* A   */.1
        JNC     ??simplemeter_HandleKeys_2
//  760     {
//  761       asm("NOP");
        NOP
//  762     }
//  763     if ( keys & HAL_KEY_SW_3 )
??simplemeter_HandleKeys_2:
        MOV     A,R7
        MOV     C,0xE0 /* A   */.4
        JNC     ??simplemeter_HandleKeys_3
//  764     {
//  765       asm("NOP");
        NOP
//  766     }
//  767     if ( keys & HAL_KEY_SW_6 )
??simplemeter_HandleKeys_3:
        MOV     A,R7
        MOV     C,0xE0 /* A   */.5
        JNC     ??simplemeter_HandleKeys_4
//  768     {
//  769       asm("NOP");
        NOP
        SJMP    ??simplemeter_HandleKeys_4
//  770     }
//  771   }
//  772   else
//  773   {
//  774     if ( keys & HAL_KEY_SW_1 )
??simplemeter_HandleKeys_0:
        MOV     A,R7
        MOV     C,0xE0 /* A   */.0
        JNC     ??simplemeter_HandleKeys_5
//  775     {
//  776       ZDOInitDevice(0);  // Join the network.
        ; Setup parameters for call to function ZDOInitDevice
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??ZDOInitDevice?relay
        MOV     A,R1
//  777     }
//  778 
//  779     if ( keys & HAL_KEY_SW_2 )
??simplemeter_HandleKeys_5:
        MOV     A,R7
        MOV     C,0xE0 /* A   */.1
        JNC     ??simplemeter_HandleKeys_6
//  780     {
//  781       // Remove mirror
//  782       zclSE_SimpleMetering_Send_RemMirrorCmd(SIMPLEMETER_ENDPOINT, &ESPAddr, TRUE, 0);
        ; Setup parameters for call to function zcl_SendCommand
        CLR     A
        MOV     ?V0 + 0,A
        MOV     ?V0 + 1,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 12)
        CLR     A
        MOV     ?V0 + 0,A
        MOV     ?V0 + 1,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     ?V0 + 0,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 15)
        CLR     A
        MOV     ?V0 + 0,A
        MOV     ?V0 + 1,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 17)
        MOV     ?V0 + 0,#0x1
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 18)
        MOV     ?V0 + 0,#0x1
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 19)
        MOV     ?V0 + 0,#0x1
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     ?V0 + 0,#0x2
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 21)
        MOV     R4,#0x2
        MOV     R5,#0x7
        MOV     R2,#ESPAddr & 0xff
        MOV     R3,#(ESPAddr >> 8) & 0xff
        MOV     R1,#0x9
        LCALL   ??zcl_SendCommand?relay
        MOV     A,#0xb
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 10)
        MOV     A,R1
//  783     }
//  784 
//  785     if ( keys & HAL_KEY_SW_3 )
//  786     {
//  787 
//  788     }
//  789 
//  790     if ( keys & HAL_KEY_SW_6 )
??simplemeter_HandleKeys_6:
        MOV     A,R7
        MOV     C,0xE0 /* A   */.5
        JNC     ??simplemeter_HandleKeys_4
//  791     {
//  792     ZDOInitDevice(0);  // Join the network.
        ; Setup parameters for call to function ZDOInitDevice
        MOV     R2,#0x0
        MOV     R3,#0x0
        LCALL   ??ZDOInitDevice?relay
        MOV     A,R1
//  793     }
//  794   }
//  795 }
??simplemeter_HandleKeys_4:
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock4
//  796 
//  797 /*********************************************************************
//  798  * @fn      simplemeter_ValidateAttrDataCB
//  799  *
//  800  * @brief   Check to see if the supplied value for the attribute data
//  801  *          is within the specified range of the attribute.
//  802  *
//  803  * @param   pAttr - pointer to attribute
//  804  * @param   pAttrInfo - pointer to attribute info
//  805  *
//  806  * @return  TRUE if data valid. FALSE otherwise.
//  807  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  808 static uint8 simplemeter_ValidateAttrDataCB( zclAttrRec_t *pAttr, zclWriteRec_t *pAttrInfo )
simplemeter_ValidateAttrDataCB:
          CFI Block cfiBlock5 Using cfiCommon0
          CFI Function simplemeter_ValidateAttrDataCB
        CODE
//  809 {
        PUSH    DPL
          CFI DPL0 Frame(CFA_SP, 4)
          CFI CFA_SP SP+-4
        PUSH    DPH
          CFI DPH0 Frame(CFA_SP, 5)
          CFI CFA_SP SP+-5
        ; Saved register size: 2
        ; Auto size: 0
//  810   uint8 valid = TRUE;
        MOV     R1,#0x1
//  811 
//  812   switch ( pAttrInfo->dataType )
        MOV     DPL,R4
        MOV     DPH,R5
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        XRL     A,#0x10
        JNZ     ??simplemeter_ValidateAttrDataCB_0
//  813   {
//  814     case ZCL_DATATYPE_BOOLEAN:
//  815       if ( ( *(pAttrInfo->attrData) != 0 ) && ( *(pAttrInfo->attrData) != 1 ) )
        MOV     DPL,R4
        MOV     DPH,R5
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        JZ      ??simplemeter_ValidateAttrDataCB_0
        MOV     DPL,R4
        MOV     DPH,R5
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOVX    A,@DPTR
        XRL     A,#0x1
        JZ      ??simplemeter_ValidateAttrDataCB_0
//  816         valid = FALSE;
        MOV     R1,#0x0
//  817       break;
//  818 
//  819     default:
//  820       break;
//  821   }
//  822 
//  823   return ( valid );
??simplemeter_ValidateAttrDataCB_0:
        POP     DPH
          CFI DPH0 SameValue
          CFI CFA_SP SP+-4
        POP     DPL
          CFI DPL0 SameValue
          CFI CFA_SP SP+-3
        LJMP    ?BRET
          CFI EndBlock cfiBlock5
//  824 }
//  825 
//  826 /*********************************************************************
//  827  * @fn      simplemeter_BasicResetCB
//  828  *
//  829  * @brief   Callback from the ZCL General Cluster Library to set all
//  830  *          the attributes of all the clusters to their factory defaults
//  831  *
//  832  * @param   none
//  833  *
//  834  * @return  none
//  835  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  836 static void simplemeter_BasicResetCB( void )
simplemeter_BasicResetCB:
          CFI Block cfiBlock6 Using cfiCommon0
          CFI Function simplemeter_BasicResetCB
        CODE
//  837 {
        ; Saved register size: 0
        ; Auto size: 0
//  838   // user should handle setting attributes to factory defaults here
//  839 }
        LJMP    ?BRET
          CFI EndBlock cfiBlock6
//  840 
//  841 /*********************************************************************
//  842  * @fn      simplemeter_IdentifyCB
//  843  *
//  844  * @brief   Callback from the ZCL General Cluster Library when
//  845  *          it received an Identity Command for this application.
//  846  *
//  847  * @param   pCmd - pointer to structure for Identify command
//  848  *
//  849  * @return  none
//  850  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  851 static void simplemeter_IdentifyCB( zclIdentify_t *pCmd )
simplemeter_IdentifyCB:
          CFI Block cfiBlock7 Using cfiCommon0
          CFI Function simplemeter_IdentifyCB
        CODE
//  852 {
        FUNCALL simplemeter_IdentifyCB, simplemeter_ProcessIdentifyTimeChange
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
//  853   simpleMeterIdentifyTime = pCmd->identifyTime;
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     DPTR,#simpleMeterIdentifyTime
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
//  854   simplemeter_ProcessIdentifyTimeChange();
        ; Setup parameters for call to function simplemeter_ProcessIdentifyTimeChange
        LCALL   ??simplemeter_ProcessIdentifyTimeChange?relay
//  855 }
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock7
//  856 
//  857 /*********************************************************************
//  858  * @fn      simplemeter_IdentifyQueryRspCB
//  859  *
//  860  * @brief   Callback from the ZCL General Cluster Library when
//  861  *          it received an Identity Query Response Command for this application.
//  862  *
//  863  * @param   pRsp - pointer to structure for Identity Query Response command
//  864  *
//  865  * @return  none
//  866  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  867 static void simplemeter_IdentifyQueryRspCB( zclIdentifyQueryRsp_t *pRsp )
simplemeter_IdentifyQueryRspCB:
          CFI Block cfiBlock8 Using cfiCommon0
          CFI Function simplemeter_IdentifyQueryRspCB
        CODE
//  868 {
        ; Saved register size: 0
        ; Auto size: 0
//  869   // add user code here
//  870 }
        LJMP    ?BRET
          CFI EndBlock cfiBlock8
//  871 
//  872 
//  873 
//  874 /*********************************************************************
//  875  * @fn      simplemeter_AlarmCB
//  876  *
//  877  * @brief   Callback from the ZCL General Cluster Library when
//  878  *          it received an Alarm request or response command for
//  879  *          this application.
//  880  *
//  881  * @param   pAlarm - pointer to structure for Alarm command
//  882  *
//  883  * @return  none
//  884  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  885 static void simplemeter_AlarmCB( zclAlarm_t *pAlarm )
simplemeter_AlarmCB:
          CFI Block cfiBlock9 Using cfiCommon0
          CFI Function simplemeter_AlarmCB
        CODE
//  886 {
        ; Saved register size: 0
        ; Auto size: 0
//  887   // add user code here
//  888 }
        LJMP    ?BRET
          CFI EndBlock cfiBlock9
//  889 
//  890 #ifdef SE_UK_EXT
//  891 /*********************************************************************
//  892  * @fn      simplemeter_GetEventLogCB
//  893  *
//  894  * @brief   Callback from the ZCL General Cluster Library when
//  895  *          it received a Get Event Log command for this
//  896  *          application.
//  897  *
//  898  * @param   srcEP - source endpoint
//  899  * @param   srcAddr - pointer to source address
//  900  * @param   pEventLog - pointer to structure for Get Event Log command
//  901  * @param   seqNum - sequence number of this command
//  902  *
//  903  * @return  none
//  904  */
//  905 static void simplemeter_GetEventLogCB( uint8 srcEP, afAddrType_t *srcAddr,
//  906                                        zclGetEventLog_t *pEventLog, uint8 seqNum )
//  907 {
//  908   // add user code here, which could fragment the event log payload if
//  909   // the entire payload doesn't fit into one Publish Event Log Command.
//  910   // Note: the Command Index starts at 0 and is incremented for each
//  911   // fragment belonging to the same command.
//  912 
//  913   // There's no event log for now! The Metering Device will support
//  914   // logging for all events configured to do so.
//  915 }
//  916 
//  917 /*********************************************************************
//  918  * @fn      simplemeter_PublishEventLogCB
//  919  *
//  920  * @brief   Callback from the ZCL General Cluster Library when
//  921  *          it received a Publish Event Log command for this
//  922  *          application.
//  923  *
//  924  * @param   srcAddr - pointer to source address
//  925  * @param   pEventLog - pointer to structure for Publish Event Log command
//  926  *
//  927  * @return  none
//  928  */
//  929 static void simplemeter_PublishEventLogCB( afAddrType_t *srcAddr, zclPublishEventLog_t *pEventLog )
//  930 {
//  931   // add user code here
//  932 }
//  933 #endif // SE_UK_EXT
//  934 
//  935 /*********************************************************************
//  936  * @fn      simplemeter_GetProfileCmdCB
//  937  *
//  938  * @brief   Callback from the ZCL SE Profile Simple Metering Cluster Library when
//  939  *          it received a Get Profile Command for
//  940  *          this application.
//  941  *
//  942  * @param   pCmd - pointer to structure for Get Profile command
//  943  * @param   srcAddr - pointer to source address
//  944  * @param   seqNum - sequence number of this command
//  945  *
//  946  * @return  none
//  947  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
//  948 static void simplemeter_GetProfileCmdCB( zclCCGetProfileCmd_t *pCmd,
simplemeter_GetProfileCmdCB:
          CFI Block cfiBlock10 Using cfiCommon0
          CFI Function simplemeter_GetProfileCmdCB
        CODE
//  949                                          afAddrType_t *srcAddr, uint8 seqNum )
//  950 {
        FUNCALL simplemeter_GetProfileCmdCB, zclSE_SimpleMetering_Send_GetProfileRsp
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 51, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 51, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x16
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-22)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 22)
        ; Saved register size: 22
        ; Auto size: 20
        MOV     A,#-0x14
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 42)
        MOV     ?V0 + 12,R2
        MOV     ?V0 + 13,R3
        MOV     ?V0 + 10,R4
        MOV     ?V0 + 11,R5
        MOV     ?V0 + 9,R1
//  951 #if defined ( ZCL_SIMPLE_METERING )
//  952   // Upon receipt of the Get Profile Command, the metering device shall send
//  953   // Get Profile Response back.
//  954 
//  955   // Variables in the following are initialized to arbitrary value for test purpose
//  956   // In real application, user shall look up the interval data captured during
//  957   // the period specified in the pCmd->endTime and return corresponding data.
//  958 
//  959   uint32 endTime;
//  960   uint8  status = zclSE_SimpleMeter_GetProfileRsp_Status_Success;
        MOV     ?V0 + 8,#0x0
//  961   uint8  profileIntervalPeriod = PROFILE_INTERVAL_PERIOD_60MIN;
        MOV     R7,#0x1
//  962   uint8  numberOfPeriodDelivered = 5;
        MOV     R6,#0x5
//  963   uint24 intervals[] = {0xa00001, 0xa00002, 0xa00003, 0xa00004, 0xa00005};
        MOV     DPTR,#`?<Constant {10485761L, 10485762L, 10485763L, 1`
        PUSH    DPL
          CFI CFA_SP SP+-1
        PUSH    DPH
          CFI CFA_SP SP+-2
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     R4,DPL
        MOV     R5,DPH
        POP     DPH
          CFI CFA_SP SP+-1
        POP     DPL
          CFI CFA_SP SP+0
        MOV     A,#0x14
        LCALL   ?MOVE_LONG8_XDATA_XDATA
//  964 
//  965   // endTime: 32 bit value (in UTC) representing the end time of the most
//  966   // chronologically recent interval being requested.
//  967   // Example: Data collected from 2:00 PM to 3:00 PM would be specified as a
//  968   // 3:00 PM interval (end time).
//  969 
//  970   // The Intervals block returned shall be the most recent block with
//  971   // its EndTime equal or older to the one in the request (pCmd->endTime).
//  972   // Requested End Time with value 0xFFFFFFFF indicats the most recent
//  973   // Intervals block is requested.
//  974 
//  975   // Sample Code - assuming the end time of the requested block is the same as
//  976   // it in the request.
//  977   endTime = pCmd->endTime;
        MOV     DPL,?V0 + 12
        MOV     DPH,?V0 + 13
        INC     DPTR
        MOV     R0,#?V0 + 0
        LCALL   ?L_MOV_X
        MOV     ?V0 + 4,?V0 + 0
        MOV     ?V0 + 5,?V0 + 1
        MOV     ?V0 + 6,?V0 + 2
        MOV     ?V0 + 7,?V0 + 3
//  978 
//  979   // Send Get Profile Response Command back
//  980 
//  981   zclSE_SimpleMetering_Send_GetProfileRsp( SIMPLEMETER_ENDPOINT, srcAddr, endTime,
//  982                                            status,
//  983                                            profileIntervalPeriod,
//  984                                            numberOfPeriodDelivered, intervals,
//  985                                            FALSE, seqNum );
        ; Setup parameters for call to function zclSE_SimpleMetering_Send_GetProfileRsp
        MOV     A,?V0 + 9
        MOV     ?V0 + 0,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 43)
        MOV     ?V0 + 0,#0x0
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 44)
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 46)
        MOV     A,R6
        MOV     ?V0 + 0,A
        MOV     R0,#?V0 + 0
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 47)
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_FOUR
          CFI CFA_XSP16 add(XSP16, 51)
        MOV     A,R7
        MOV     R5,A
        MOV     R4,?V0 + 8
        MOV     R2,?V0 + 10
        MOV     R3,?V0 + 11
        MOV     R1,#0x9
        LCALL   ??zclSE_SimpleMetering_Send_GetProfileRsp?relay
        MOV     A,#0x9
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 42)
        MOV     A,R1
//  986 #endif // ZCL_SIMPLE_METERING
//  987 }
        MOV     A,#0x14
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     R7,#0xe
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock10
//  988 
//  989 /*********************************************************************
//  990  * @fn      simplemeter_GetProfileRspCB
//  991  *
//  992  * @brief   Callback from the ZCL SE Profile Simple Metering Cluster Library when
//  993  *          it received a Get Profile Response for
//  994  *          this application.
//  995  *
//  996  * @param   pCmd - pointer to structure for Get Profile Response command
//  997  * @param   srcAddr - pointer to source address
//  998  * @param   seqNum - sequence number of this command
//  999  *
// 1000  * @return  none
// 1001  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1002 static void simplemeter_GetProfileRspCB( zclCCGetProfileRsp_t *pCmd,
simplemeter_GetProfileRspCB:
          CFI Block cfiBlock11 Using cfiCommon0
          CFI Function simplemeter_GetProfileRspCB
        CODE
// 1003                                          afAddrType_t *srcAddr, uint8 seqNum )
// 1004 {
        ; Saved register size: 0
        ; Auto size: 0
// 1005   // add user code here
// 1006 }
        LJMP    ?BRET
          CFI EndBlock cfiBlock11
// 1007 
// 1008 /*********************************************************************
// 1009  * @fn      simplemeter_ReqMirrorRspCB
// 1010  *
// 1011  * @brief   Callback from the ZCL SE Profile Simple Metering Cluster Library when
// 1012  *          it received a Request Mirror Response for
// 1013  *          this application.
// 1014  *
// 1015  * @param   pCmd - pointer to structure for Request Mirror Response command
// 1016  * @param   srcAddr - pointer to source address
// 1017  * @param   seqNum - sequence number of this command
// 1018  *
// 1019  * @return  none
// 1020  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1021 static void simplemeter_ReqMirrorRspCB( zclCCReqMirrorRsp_t *pCmd,
simplemeter_ReqMirrorRspCB:
          CFI Block cfiBlock12 Using cfiCommon0
          CFI Function simplemeter_ReqMirrorRspCB
        CODE
// 1022                                         afAddrType_t *srcAddr, uint8 seqNum )
// 1023 {
        ; Saved register size: 0
        ; Auto size: 0
// 1024 #if defined ( ZCL_SIMPLE_METERING )
// 1025 #if defined ( SE_UK_EXT ) && defined ( SE_MIRROR )
// 1026   if ( pCmd != NULL )
// 1027   {
// 1028     if (pCmd->endpointId == 0xFFFF)
// 1029     {
// 1030       // The create mirror failed, try another ESP
// 1031       // Add user code
// 1032     }
// 1033     else
// 1034     {
// 1035       // Record the mirror address and endpoint
// 1036       osal_memcpy(&mirrorAddr, srcAddr, sizeof(afAddrType_t));
// 1037       mirrorAddr.endPoint = pCmd->endpointId;
// 1038 
// 1039       // Send a report attribute to the mirror endpoint
// 1040       if (pSeReportCmd)
// 1041       {
// 1042         zcl_SendReportCmd( SIMPLEMETER_ENDPOINT, &mirrorAddr,
// 1043                            ZCL_CLUSTER_ID_SE_SIMPLE_METERING, pSeReportCmd,
// 1044                            ZCL_FRAME_SERVER_CLIENT_DIR, 1, 0 );
// 1045       }
// 1046 
// 1047       if (pBasicReportCmd)
// 1048       {
// 1049         zcl_SendReportCmd( SIMPLEMETER_ENDPOINT, &mirrorAddr,
// 1050                            ZCL_CLUSTER_ID_GEN_BASIC, pBasicReportCmd,
// 1051                            ZCL_FRAME_SERVER_CLIENT_DIR, 1, 0 );
// 1052       }
// 1053     }
// 1054   }
// 1055 #endif  // SE_UK_EXT && SE_MIRROR
// 1056 #endif  // ZCL_SIMPLE_METERING
// 1057 }
        LJMP    ?BRET
          CFI EndBlock cfiBlock12
// 1058 
// 1059 /*********************************************************************
// 1060  * @fn      simplemeter_MirrorRemRspCB
// 1061  *
// 1062  * @brief   Callback from the ZCL SE Profile Simple Metering Cluster Library when
// 1063  *          it received a Mirror Remove Response for
// 1064  *          this application.
// 1065  *
// 1066  * @param   pCmd - pointer to structure for Mirror Remove Response command
// 1067  * @param   srcAddr - pointer to source address
// 1068  * @param   seqNum - sequence number of this command
// 1069  *
// 1070  * @return  none
// 1071  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1072 static void simplemeter_MirrorRemRspCB( zclCCMirrorRemRsp_t *pCmd,
simplemeter_MirrorRemRspCB:
          CFI Block cfiBlock13 Using cfiCommon0
          CFI Function simplemeter_MirrorRemRspCB
        CODE
// 1073                                         afAddrType_t *srcAddr, uint8 seqNum )
// 1074 {
        FUNCALL simplemeter_MirrorRemRspCB, osal_stop_timerEx
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 11, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 11, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xb
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 11)
        ; Saved register size: 11
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
        MOV     ?V0 + 0,R4
        MOV     ?V0 + 1,R5
        MOV     ?V0 + 2,R1
// 1075 #if defined ( ZCL_SIMPLE_METERING )
// 1076   osal_stop_timerEx( simpleMeterTaskID, SIMPLEMETER_REPORT_ATTRIBUTE_EVT );
        ; Setup parameters for call to function osal_stop_timerEx
        MOV     R2,#0x8
        MOV     R3,#0x0
        MOV     DPTR,#simpleMeterTaskID
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??osal_stop_timerEx?relay
        MOV     A,R1
// 1077 #endif  // ZCL_SIMPLE_METERING
// 1078 }
        MOV     R7,#0x3
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock13
// 1079 
// 1080 #if defined ( SE_UK_EXT )
// 1081 /*********************************************************************
// 1082  * @fn      simplemeter_GetSnapshotCmdCB
// 1083  *
// 1084  * @brief   Callback from the ZCL SE Profile Simple Metering Cluster Library when
// 1085  *          it received a Get Snapshot Command for
// 1086  *          this application.
// 1087  *
// 1088  * @param   pCmd - pointer to structure for Get Snapshot command
// 1089  * @param   srcAddr - pointer to source address
// 1090  * @param   seqNum - sequence number of this command
// 1091  *
// 1092  * @return  none
// 1093  */
// 1094 static void simplemeter_GetSnapshotCmdCB( zclCCReqGetSnapshotCmd_t *pCmd,
// 1095                                           afAddrType_t *srcAddr, uint8 seqNum )
// 1096 {
// 1097   // add user code here
// 1098 }
// 1099 
// 1100 /*********************************************************************
// 1101  * @fn      simplemeter_TakeSnapshotCmdCB
// 1102  *
// 1103  * @brief   Callback from the ZCL SE Profile Simple Metering Cluster Library when
// 1104  *          it received a Take Snapshot Command for
// 1105  *          this application.
// 1106  *
// 1107  * @param   srcAddr - pointer to source address
// 1108  * @param   seqNum - sequence number of this command
// 1109  *
// 1110  * @return  none
// 1111  */
// 1112 static void simplemeter_TakeSnapshotCmdCB( afAddrType_t *srcAddr, uint8 seqNum )
// 1113 {
// 1114   // add user code  to store the snapshot
// 1115 }
// 1116 
// 1117 /*********************************************************************
// 1118  * @fn      simplemeter_MirrorReportAttrRspCB
// 1119  *
// 1120  * @brief   Callback from the ZCL SE Profile Simple Metering Cluster Library when
// 1121  *          it received a Mirror Report Attribute Response for
// 1122  *          this application.
// 1123  *
// 1124  * @param   pCmd - pointer to structure for Mirror Report Attribute Response command
// 1125  * @param   srcAddr - pointer to source address
// 1126  * @param   seqNum - sequence number of this command
// 1127  *
// 1128  * @return  none
// 1129  */
// 1130 static void simplemeter_MirrorReportAttrRspCB( zclCCReqMirrorReportAttrRsp_t *pCmd,
// 1131                                               afAddrType_t *srcAddr, uint8 seqNum )
// 1132 {
// 1133   // add user code here
// 1134 }
// 1135 
// 1136 /*********************************************************************
// 1137  * @fn      simplemeter_PublishTariffInformationCB
// 1138  *
// 1139  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1140  *          it received a Publish Tariff Information for this application.
// 1141  *
// 1142  * @param   pCmd - pointer to structure for Publish Tariff Information command
// 1143  * @param   srcAddr - pointer to source address
// 1144  * @param   seqNum - sequence number of this command
// 1145  *
// 1146  * @return  none
// 1147  */
// 1148 static void simplemeter_PublishTariffInformationCB( zclCCPublishTariffInformation_t *pCmd,
// 1149                                                     afAddrType_t *srcAddr, uint8 seqNum )
// 1150 {
// 1151   // add user code here
// 1152 }
// 1153 
// 1154 /*********************************************************************
// 1155  * @fn      simplemeter_PublishPriceMatrixCB
// 1156  *
// 1157  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1158  *          it received a Publish Price Matrix for this application.
// 1159  *
// 1160  * @param   pCmd - pointer to structure for Publish Price Matrix command
// 1161  * @param   srcAddr - pointer to source address
// 1162  * @param   seqNum - sequence number of this command
// 1163  *
// 1164  * @return  none
// 1165  */
// 1166 static void simplemeter_PublishPriceMatrixCB( zclCCPublishPriceMatrix_t *pCmd,
// 1167                                               afAddrType_t *srcAddr, uint8 seqNum )
// 1168 {
// 1169   // add user code here
// 1170 }
// 1171 
// 1172 /*********************************************************************
// 1173  * @fn      simplemeter_PublishBlockThresholdsCB
// 1174  *
// 1175  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1176  *          it received a Publish Block Thresholds for this application.
// 1177  *
// 1178  * @param   pCmd - pointer to structure for Publish Block Thresholds command
// 1179  * @param   srcAddr - pointer to source address
// 1180  * @param   seqNum - sequence number of this command
// 1181  *
// 1182  * @return  none
// 1183  */
// 1184 static void simplemeter_PublishBlockThresholdsCB( zclCCPublishBlockThresholds_t *pCmd,
// 1185                                                   afAddrType_t *srcAddr, uint8 seqNum )
// 1186 {
// 1187   // add user code here
// 1188 }
// 1189 
// 1190 /*********************************************************************
// 1191  * @fn      simplemeter_PublishConversionFactorCB
// 1192  *
// 1193  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1194  *          it received a Publish Conversion Factor for this application.
// 1195  *
// 1196  * @param   pCmd - pointer to structure for Publish Conversion Factor command
// 1197  * @param   srcAddr - pointer to source address
// 1198  * @param   seqNum - sequence number of this command
// 1199  *
// 1200  * @return  none
// 1201  */
// 1202 static void simplemeter_PublishConversionFactorCB( zclCCPublishConversionFactor_t *pCmd,
// 1203                                                    afAddrType_t *srcAddr, uint8 seqNum )
// 1204 {
// 1205   // add user code here
// 1206 }
// 1207 
// 1208 /*********************************************************************
// 1209  * @fn      simplemeter_PublishCalorificValueCB
// 1210  *
// 1211  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1212  *          it received a Publish Calorific Value for this application.
// 1213  *
// 1214  * @param   pCmd - pointer to structure for Publish Calorific Value command
// 1215  * @param   srcAddr - pointer to source address
// 1216  * @param   seqNum - sequence number of this command
// 1217  *
// 1218  * @return  none
// 1219  */
// 1220 static void simplemeter_PublishCalorificValueCB( zclCCPublishCalorificValue_t *pCmd,
// 1221                                                  afAddrType_t *srcAddr, uint8 seqNum )
// 1222 {
// 1223   // add user code here
// 1224 }
// 1225 
// 1226 /*********************************************************************
// 1227  * @fn      simplemeter_PublishCO2ValueCB
// 1228  *
// 1229  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1230  *          it received a Publish CO2 Value for this application.
// 1231  *
// 1232  * @param   pCmd - pointer to structure for Publish CO2 Value command
// 1233  * @param   srcAddr - pointer to source address
// 1234  * @param   seqNum - sequence number of this command
// 1235  *
// 1236  * @return  none
// 1237  */
// 1238 static void simplemeter_PublishCO2ValueCB( zclCCPublishCO2Value_t *pCmd,
// 1239                                            afAddrType_t *srcAddr, uint8 seqNum )
// 1240 {
// 1241   // add user code here
// 1242 }
// 1243 
// 1244 /*********************************************************************
// 1245  * @fn      simplemeter_PublishCPPEventCB
// 1246  *
// 1247  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1248  *          it received a Publish CPP Event for this application.
// 1249  *
// 1250  * @param   pCmd - pointer to structure for Publish CPP Event command
// 1251  * @param   srcAddr - pointer to source address
// 1252  * @param   seqNum - sequence number of this command
// 1253  *
// 1254  * @return  none
// 1255  */
// 1256 static void simplemeter_PublishCPPEventCB( zclCCPublishCPPEvent_t *pCmd,
// 1257                                            afAddrType_t *srcAddr, uint8 seqNum )
// 1258 {
// 1259   // add user code here
// 1260 }
// 1261 
// 1262 /*********************************************************************
// 1263  * @fn      simplemeter_PublishBillingPeriodCB
// 1264  *
// 1265  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1266  *          it received a Publish Billing Period for this application.
// 1267  *
// 1268  * @param   pCmd - pointer to structure for Publish Billing Period command
// 1269  * @param   srcAddr - pointer to source address
// 1270  * @param   seqNum - sequence number of this command
// 1271  *
// 1272  * @return  none
// 1273  */
// 1274 static void simplemeter_PublishBillingPeriodCB( zclCCPublishBillingPeriod_t *pCmd,
// 1275                                                 afAddrType_t *srcAddr, uint8 seqNum )
// 1276 {
// 1277   // add user code here
// 1278 }
// 1279 
// 1280 /*********************************************************************
// 1281  * @fn      simplemeter_PublishConsolidatedBillCB
// 1282  *
// 1283  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1284  *          it received a Publish Consolidated Bill for this application.
// 1285  *
// 1286  * @param   pCmd - pointer to structure for Publish Consolidated Bill command
// 1287  * @param   srcAddr - pointer to source address
// 1288  * @param   seqNum - sequence number of this command
// 1289  *
// 1290  * @return  none
// 1291  */
// 1292 static void simplemeter_PublishConsolidatedBillCB( zclCCPublishConsolidatedBill_t *pCmd,
// 1293                                                    afAddrType_t *srcAddr, uint8 seqNum )
// 1294 {
// 1295   // add user code here
// 1296 }
// 1297 
// 1298 /*********************************************************************
// 1299  * @fn      simplemeter_PublishCreditPaymentInfoCB
// 1300  *
// 1301  * @brief   Callback from the ZCL SE Profile Price Cluster Library when
// 1302  *          it received a Publish Credit Payment Info for this application.
// 1303  *
// 1304  * @param   pCmd - pointer to structure for Publish Credit Payment Info command
// 1305  * @param   srcAddr - pointer to source address
// 1306  * @param   seqNum - sequence number of this command
// 1307  *
// 1308  * @return  none
// 1309  */
// 1310 static void simplemeter_PublishCreditPaymentInfoCB( zclCCPublishCreditPaymentInfo_t *pCmd,
// 1311                                                     afAddrType_t *srcAddr, uint8 seqNum )
// 1312 {
// 1313   // add user code here
// 1314 }
// 1315 
// 1316 /*********************************************************************
// 1317  * @fn      simplemeter_ChangeDebtCB
// 1318  *
// 1319  * @brief   Callback from the ZCL SE Profile Prepayment Cluster Library when
// 1320  *          it received a Change Debt for this application.
// 1321  *
// 1322  * @param   pCmd - pointer to structure for Change Debt command
// 1323  * @param   srcAddr - pointer to source address
// 1324  * @param   seqNum - sequence number of this command
// 1325  *
// 1326  * @return  none
// 1327  */
// 1328 static void simplemeter_ChangeDebtCB( zclCCChangeDebt_t *pCmd,
// 1329                                       afAddrType_t *srcAddr, uint8 seqNum )
// 1330 {
// 1331   // add user code here
// 1332 }
// 1333 
// 1334 /*********************************************************************
// 1335  * @fn      simplemeter_EmergencyCreditSetupCB
// 1336  *
// 1337  * @brief   Callback from the ZCL SE Profile Prepayment Cluster Library when
// 1338  *          it received a Emergency Credit Setup for this application.
// 1339  *
// 1340  * @param   pCmd - pointer to structure for Emergency Credit Setup command
// 1341  * @param   srcAddr - pointer to source address
// 1342  * @param   seqNum - sequence number of this command
// 1343  *
// 1344  * @return  none
// 1345  */
// 1346 static void simplemeter_EmergencyCreditSetupCB( zclCCEmergencyCreditSetup_t *pCmd,
// 1347                                                 afAddrType_t *srcAddr, uint8 seqNum )
// 1348 {
// 1349   // add user code here
// 1350 }
// 1351 
// 1352 /*********************************************************************
// 1353  * @fn      simplemeter_ConsumerTopupCB
// 1354  *
// 1355  * @brief   Callback from the ZCL SE Profile Prepayment Cluster Library when
// 1356  *          it received a Consumer Topup for this application.
// 1357  *
// 1358  * @param   pCmd - pointer to structure for Consumer Topup command
// 1359  * @param   srcAddr - pointer to source address
// 1360  * @param   seqNum - sequence number of this command
// 1361  *
// 1362  * @return  none
// 1363  */
// 1364 static void simplemeter_ConsumerTopupCB( zclCCConsumerTopup_t *pCmd,
// 1365                                          afAddrType_t *srcAddr, uint8 seqNum )
// 1366 {
// 1367   // add user code here
// 1368 }
// 1369 
// 1370 /*********************************************************************
// 1371  * @fn      simplemeter_CreditAdjustmentCB
// 1372  *
// 1373  * @brief   Callback from the ZCL SE Profile Prepayment Cluster Library when
// 1374  *          it received a Credit Adjustment for this application.
// 1375  *
// 1376  * @param   pCmd - pointer to structure for Credit Adjustment command
// 1377  * @param   srcAddr - pointer to source address
// 1378  * @param   seqNum - sequence number of this command
// 1379  *
// 1380  * @return  none
// 1381  */
// 1382 static void simplemeter_CreditAdjustmentCB( zclCCCreditAdjustment_t *pCmd,
// 1383                                             afAddrType_t *srcAddr, uint8 seqNum )
// 1384 {
// 1385   // add user code here
// 1386 }
// 1387 
// 1388 /*********************************************************************
// 1389  * @fn      simplemeter_ChangePaymentModeCB
// 1390  *
// 1391  * @brief   Callback from the ZCL SE Profile Prepayment Cluster Library when
// 1392  *          it received a Change Payment Mode for this application.
// 1393  *
// 1394  * @param   pCmd - pointer to structure for Change Payment Mode command
// 1395  * @param   srcAddr - pointer to source address
// 1396  * @param   seqNum - sequence number of this command
// 1397  *
// 1398  * @return  none
// 1399  */
// 1400 static void simplemeter_ChangePaymentModeCB( zclCCChangePaymentMode_t *pCmd,
// 1401                                              afAddrType_t *srcAddr, uint8 seqNum )
// 1402 {
// 1403   // add user code here
// 1404 }
// 1405 
// 1406 /*********************************************************************
// 1407  * @fn      simplemeter_GetPrepaySnapshotCB
// 1408  *
// 1409  * @brief   Callback from the ZCL SE Profile Prepayment Cluster Library when
// 1410  *          it received a Get Prepay Snapshot for this application.
// 1411  *
// 1412  * @param   pCmd - pointer to structure for Get Prepay Snapshot command
// 1413  * @param   srcAddr - pointer to source address
// 1414  * @param   seqNum - sequence number of this command
// 1415  *
// 1416  * @return  none
// 1417  */
// 1418 static void simplemeter_GetPrepaySnapshotCB( zclCCGetPrepaySnapshot_t *pCmd,
// 1419                                              afAddrType_t *srcAddr, uint8 seqNum )
// 1420 {
// 1421   // add user code here
// 1422 }
// 1423 
// 1424 /*********************************************************************
// 1425  * @fn      simplemeter_GetTopupLogCB
// 1426  *
// 1427  * @brief   Callback from the ZCL SE Profile Prepayment Cluster Library when
// 1428  *          it received a Get Topup Log for this application.
// 1429  *
// 1430  * @param   numEvents - number of events
// 1431  * @param   srcAddr - pointer to source address
// 1432  * @param   seqNum - sequence number of this command
// 1433  *
// 1434  * @return  none
// 1435  */
// 1436 static void simplemeter_GetTopupLogCB( uint8 numEvents,
// 1437                                        afAddrType_t *srcAddr, uint8 seqNum )
// 1438 {
// 1439   // add user code here
// 1440 }
// 1441 
// 1442 /*********************************************************************
// 1443  * @fn      simplemeter_SetLowCreditWarningLevelCB
// 1444  *
// 1445  * @brief   Callback from the ZCL SE Profile Prepayment Cluster Library when
// 1446  *          it received a Set Low Credit Warning Level for this application.
// 1447  *
// 1448  * @param   numEvents - number of events
// 1449  * @param   srcAddr - pointer to source address
// 1450  * @param   seqNum - sequence number of this command
// 1451  *
// 1452  * @return  none
// 1453  */
// 1454 static void simplemeter_SetLowCreditWarningLevelCB( uint8 numEvents,
// 1455                                                     afAddrType_t *srcAddr, uint8 seqNum )
// 1456 {
// 1457   // add user code here
// 1458 }
// 1459 
// 1460 /*********************************************************************
// 1461  * @fn      simplemeter_GetDebtRepaymentLogCB
// 1462  *
// 1463  * @brief   Callback from the ZCL SE Profile Prepayment Cluster Library when
// 1464  *          it received a Get Debt Repayment Log for this application.
// 1465  *
// 1466  * @param   pCmd - pointer to structure for Get Debt Repayment Log command
// 1467  * @param   srcAddr - pointer to source address
// 1468  * @param   seqNum - sequence number of this command
// 1469  *
// 1470  * @return  none
// 1471  */
// 1472 static void simplemeter_GetDebtRepaymentLogCB( zclCCGetDebtRepaymentLog_t *pCmd,
// 1473                                                afAddrType_t *srcAddr, uint8 seqNum )
// 1474 {
// 1475   // add user code here
// 1476 }
// 1477 #endif  // SE_UK_EXT
// 1478 
// 1479 /******************************************************************************
// 1480  *
// 1481  *  Functions for processing ZCL Foundation incoming Command/Response messages
// 1482  *
// 1483  *****************************************************************************/
// 1484 
// 1485 /*********************************************************************
// 1486  * @fn      simplemeter_ProcessZCLMsg
// 1487  *
// 1488  * @brief   Process ZCL Foundation incoming message
// 1489  *
// 1490  * @param   pInMsg - message to process
// 1491  *
// 1492  * @return  none
// 1493  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1494 static void simplemeter_ProcessZCLMsg( zclIncomingMsg_t *pInMsg )
simplemeter_ProcessZCLMsg:
          CFI Block cfiBlock14 Using cfiCommon0
          CFI Function simplemeter_ProcessZCLMsg
        CODE
// 1495 {
        FUNCALL simplemeter_ProcessZCLMsg, simplemeter_ProcessInReadRspCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZCLMsg, simplemeter_ProcessInWriteRspCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZCLMsg, simplemeter_ProcessInConfigReportCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZCLMsg, simplemeter_ProcessInConfigReportRspCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZCLMsg, simplemeter_ProcessInReadReportCfgCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZCLMsg, simplemeter_ProcessInReadReportCfgRspCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZCLMsg, simplemeter_ProcessInReportCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZCLMsg, simplemeter_ProcessInDefaultRspCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessZCLMsg, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 9, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 9, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
        MOV     A,R2
        MOV     R6,A
        MOV     A,R3
        MOV     R7,A
// 1496   switch ( pInMsg->zclHdr.commandID )
        MOV     DPL,R6
        MOV     DPH,R7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        DEC     A
        JZ      ??simplemeter_ProcessZCLMsg_0
        ADD     A,#-0x3
        JZ      ??simplemeter_ProcessZCLMsg_1
        ADD     A,#-0x2
        JZ      ??simplemeter_ProcessZCLMsg_2
        DEC     A
        JZ      ??simplemeter_ProcessZCLMsg_3
        DEC     A
        JZ      ??simplemeter_ProcessZCLMsg_4
        DEC     A
        JZ      ??simplemeter_ProcessZCLMsg_5
        DEC     A
        JZ      ??simplemeter_ProcessZCLMsg_6
        DEC     A
        JZ      ??simplemeter_ProcessZCLMsg_7
        SJMP    ??simplemeter_ProcessZCLMsg_8
// 1497   {
// 1498 #if defined ( ZCL_READ )
// 1499     case ZCL_CMD_READ_RSP:
// 1500       simplemeter_ProcessInReadRspCmd( pInMsg );
??simplemeter_ProcessZCLMsg_0:
        ; Setup parameters for call to function simplemeter_ProcessInReadRspCmd
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??simplemeter_ProcessInReadRspCmd?relay
        MOV     A,R1
// 1501       break;
        SJMP    ??simplemeter_ProcessZCLMsg_8
// 1502 #endif // ZCL_READ
// 1503 #if defined ( ZCL_WRITE )
// 1504     case ZCL_CMD_WRITE_RSP:
// 1505       simplemeter_ProcessInWriteRspCmd( pInMsg );
??simplemeter_ProcessZCLMsg_1:
        ; Setup parameters for call to function simplemeter_ProcessInWriteRspCmd
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??simplemeter_ProcessInWriteRspCmd?relay
        MOV     A,R1
// 1506       break;
        SJMP    ??simplemeter_ProcessZCLMsg_8
// 1507 #endif // ZCL_READ
// 1508 #if defined ( ZCL_REPORT )
// 1509     case ZCL_CMD_CONFIG_REPORT:
// 1510       simplemeter_ProcessInConfigReportCmd( pInMsg );
??simplemeter_ProcessZCLMsg_2:
        ; Setup parameters for call to function simplemeter_ProcessInConfigReportCmd
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??simplemeter_ProcessInConfigReportCmd?relay
        MOV     A,R1
// 1511       break;
        SJMP    ??simplemeter_ProcessZCLMsg_8
// 1512 
// 1513     case ZCL_CMD_CONFIG_REPORT_RSP:
// 1514       simplemeter_ProcessInConfigReportRspCmd( pInMsg );
??simplemeter_ProcessZCLMsg_3:
        ; Setup parameters for call to function simplemeter_ProcessInConfigReportRspCmd
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??simplemeter_ProcessInConfigReportRspCmd?relay
        MOV     A,R1
// 1515       break;
        SJMP    ??simplemeter_ProcessZCLMsg_8
// 1516 
// 1517     case ZCL_CMD_READ_REPORT_CFG:
// 1518       simplemeter_ProcessInReadReportCfgCmd( pInMsg );
??simplemeter_ProcessZCLMsg_4:
        ; Setup parameters for call to function simplemeter_ProcessInReadReportCfgCmd
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??simplemeter_ProcessInReadReportCfgCmd?relay
        MOV     A,R1
// 1519       break;
        SJMP    ??simplemeter_ProcessZCLMsg_8
// 1520 
// 1521     case ZCL_CMD_READ_REPORT_CFG_RSP:
// 1522       simplemeter_ProcessInReadReportCfgRspCmd( pInMsg );
??simplemeter_ProcessZCLMsg_5:
        ; Setup parameters for call to function simplemeter_ProcessInReadReportCfgRspCmd
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??simplemeter_ProcessInReadReportCfgRspCmd?rela
        MOV     A,R1
// 1523       break;
        SJMP    ??simplemeter_ProcessZCLMsg_8
// 1524 
// 1525     case ZCL_CMD_REPORT:
// 1526       simplemeter_ProcessInReportCmd( pInMsg );
??simplemeter_ProcessZCLMsg_6:
        ; Setup parameters for call to function simplemeter_ProcessInReportCmd
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??simplemeter_ProcessInReportCmd?relay
        MOV     A,R1
// 1527       break;
        SJMP    ??simplemeter_ProcessZCLMsg_8
// 1528 #endif // ZCL_REPORT
// 1529     case ZCL_CMD_DEFAULT_RSP:
// 1530       simplemeter_ProcessInDefaultRspCmd( pInMsg );
??simplemeter_ProcessZCLMsg_7:
        ; Setup parameters for call to function simplemeter_ProcessInDefaultRspCmd
        MOV     A,R6
        MOV     R2,A
        MOV     A,R7
        MOV     R3,A
        LCALL   ??simplemeter_ProcessInDefaultRspCmd?relay
        MOV     A,R1
// 1531       break;
// 1532 #if defined ( ZCL_DISCOVER )
// 1533     case ZCL_CMD_DISCOVER_RSP:
// 1534       simplemeter_ProcessInDiscRspCmd( pInMsg );
// 1535       break;
// 1536 #endif // ZCL_DISCOVER
// 1537     default:
// 1538       break;
// 1539   }
// 1540 
// 1541   if ( pInMsg->attrCmd != NULL )
??simplemeter_ProcessZCLMsg_8:
        MOV     A,R6
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        ORL     A,R1
        JZ      ??simplemeter_ProcessZCLMsg_9
// 1542   {
// 1543     // free the parsed command
// 1544     osal_mem_free( pInMsg->attrCmd );
        ; Setup parameters for call to function osal_mem_free
        MOV     A,R6
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        LCALL   ??osal_mem_free?relay
// 1545     pInMsg->attrCmd = NULL;
        MOV     A,R6
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,#0x0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
// 1546   }
// 1547 }
??simplemeter_ProcessZCLMsg_9:
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock14
// 1548 
// 1549 #if defined ( ZCL_READ )
// 1550 /*********************************************************************
// 1551  * @fn      simplemeter_ProcessInReadRspCmd
// 1552  *
// 1553  * @brief   Process the "Profile" Read Response Command
// 1554  *
// 1555  * @param   pInMsg - incoming message to process
// 1556  *
// 1557  * @return  none
// 1558  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1559 static uint8 simplemeter_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg )
simplemeter_ProcessInReadRspCmd:
          CFI Block cfiBlock15 Using cfiCommon0
          CFI Function simplemeter_ProcessInReadRspCmd
        CODE
// 1560 {
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
// 1561   zclReadRspCmd_t *readRspCmd;
// 1562   uint8 i;
// 1563 
// 1564   readRspCmd = (zclReadRspCmd_t *)pInMsg->attrCmd;
        MOV     A,R2
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
// 1565   for (i = 0; i < readRspCmd->numAttr; i++)
        MOV     R4,#0x0
??simplemeter_ProcessInReadRspCmd_0:
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,R4
        CLR     C
        SUBB    A,R0
        JNC     ??simplemeter_ProcessInReadRspCmd_1
        INC     R4
        SJMP    ??simplemeter_ProcessInReadRspCmd_0
// 1566   {
// 1567     // Notify the originator of the results of the original read attributes
// 1568     // attempt and, for each successfull request, the value of the requested
// 1569     // attribute
// 1570   }
// 1571 
// 1572   return TRUE;
??simplemeter_ProcessInReadRspCmd_1:
        MOV     R1,#0x1
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock15
// 1573 }
// 1574 #endif // ZCL_READ
// 1575 
// 1576 #if defined ( ZCL_WRITE )
// 1577 /*********************************************************************
// 1578  * @fn      simplemeter_ProcessInWriteRspCmd
// 1579  *
// 1580  * @brief   Process the "Profile" Write Response Command
// 1581  *
// 1582  * @param   pInMsg - incoming message to process
// 1583  *
// 1584  * @return  none
// 1585  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1586 static uint8 simplemeter_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg )
simplemeter_ProcessInWriteRspCmd:
          CFI Block cfiBlock16 Using cfiCommon0
          CFI Function simplemeter_ProcessInWriteRspCmd
        CODE
// 1587 {
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
// 1588   zclWriteRspCmd_t *writeRspCmd;
// 1589   uint8 i;
// 1590 
// 1591   writeRspCmd = (zclWriteRspCmd_t *)pInMsg->attrCmd;
        MOV     A,R2
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
// 1592   for (i = 0; i < writeRspCmd->numAttr; i++)
        MOV     R4,#0x0
??simplemeter_ProcessInWriteRspCmd_0:
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,R4
        CLR     C
        SUBB    A,R0
        JNC     ??simplemeter_ProcessInWriteRspCmd_1
        INC     R4
        SJMP    ??simplemeter_ProcessInWriteRspCmd_0
// 1593   {
// 1594     // Notify the device of the results of the its original write attributes
// 1595     // command.
// 1596   }
// 1597 
// 1598   return TRUE;
??simplemeter_ProcessInWriteRspCmd_1:
        MOV     R1,#0x1
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock16
// 1599 }
// 1600 #endif // ZCL_WRITE
// 1601 
// 1602 #if defined ( ZCL_REPORT )
// 1603 /*********************************************************************
// 1604  * @fn      simplemeter_ProcessInConfigReportCmd
// 1605  *
// 1606  * @brief   Process the "Profile" Configure Reporting Command
// 1607  *
// 1608  * @param   pInMsg - incoming message to process
// 1609  *
// 1610  * @return  TRUE if attribute was found in the Attribute list,
// 1611  *          FALSE if not
// 1612  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1613 static uint8 simplemeter_ProcessInConfigReportCmd( zclIncomingMsg_t *pInMsg )
simplemeter_ProcessInConfigReportCmd:
          CFI Block cfiBlock17 Using cfiCommon0
          CFI Function simplemeter_ProcessInConfigReportCmd
        CODE
// 1614 {
        FUNCALL simplemeter_ProcessInConfigReportCmd, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 28, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 28, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInConfigReportCmd, zclFindAttrRec
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 30, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 30, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInConfigReportCmd, zcl_SendConfigReportRspCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 33, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 33, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInConfigReportCmd, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 28, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 28, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x14
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 20)
        ; Saved register size: 20
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 28)
        MOV     ?V0 + 4,R2
        MOV     ?V0 + 5,R3
// 1615   zclCfgReportCmd_t *cfgReportCmd;
// 1616   zclCfgReportRec_t *reportRec;
// 1617   zclCfgReportRspCmd_t *cfgReportRspCmd;
// 1618   zclAttrRec_t attrRec;
// 1619   uint8 status;
// 1620   uint8 i, j = 0;
        MOV     R6,#0x0
// 1621 
// 1622   cfgReportCmd = (zclCfgReportCmd_t *)pInMsg->attrCmd;
        MOV     A,?V0 + 4
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,?V0 + 5
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     ?V0 + 6,R0
        MOV     ?V0 + 7,R1
// 1623 
// 1624   // Allocate space for the response command
// 1625   cfgReportRspCmd = (zclCfgReportRspCmd_t *)osal_mem_alloc( sizeof ( zclCfgReportRspCmd_t ) + \ 
// 1626                                         sizeof ( zclCfgReportStatus_t) * cfgReportCmd->numAttr );
        ; Setup parameters for call to function osal_mem_alloc
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x4
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x4
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,R0
        ADD     A,#0x1
        MOV     R2,A
        MOV     A,R1
        ADDC    A,#0x0
        MOV     R3,A
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 10,R2
        MOV     ?V0 + 11,R3
        MOV     ?V0 + 8,?V0 + 10
        MOV     ?V0 + 9,?V0 + 11
// 1627   if ( cfgReportRspCmd == NULL )
        MOV     A,?V0 + 8
        ORL     A,?V0 + 9
        JNZ     ??simplemeter_ProcessInConfigReportCmd_0
// 1628     return FALSE; // EMBEDDED RETURN
        MOV     R1,#0x0
        LJMP    ??simplemeter_ProcessInConfigReportCmd_1 & 0xFFFF
// 1629 
// 1630   // Process each Attribute Reporting Configuration record
// 1631   for ( i = 0; i < cfgReportCmd->numAttr; i++ )
??simplemeter_ProcessInConfigReportCmd_0:
        MOV     ?V0 + 2,#0x0
??simplemeter_ProcessInConfigReportCmd_2:
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,?V0 + 2
        CLR     C
        SUBB    A,R0
        JC      $+5
        LJMP    ??simplemeter_ProcessInConfigReportCmd_3 & 0xFFFF
// 1632   {
// 1633     reportRec = &(cfgReportCmd->attrList[i]);
        MOV     A,?V0 + 2
        MOV     R0,?V0 + 2
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0xc
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0xc
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,?V0 + 6
        ADD     A,R0
        MOV     DPL,A
        MOV     A,?V0 + 7
        ADDC    A,R1
        MOV     DPH,A
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
// 1634 
// 1635     status = ZCL_STATUS_SUCCESS;
        MOV     R7,#0x0
// 1636 
// 1637     if ( zclFindAttrRec( SIMPLEMETER_ENDPOINT, pInMsg->clusterId, reportRec->attrID, &attrRec ) )
        ; Setup parameters for call to function zclFindAttrRec
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 10,DPL
        MOV     ?V0 + 11,DPH
        MOV     R0,#?V0 + 10
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 30)
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        MOV     R1,#0x9
        LCALL   ??zclFindAttrRec?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 28)
        MOV     A,R1
        JNZ     $+5
        LJMP    ??simplemeter_ProcessInConfigReportCmd_4 & 0xFFFF
// 1638     {
// 1639       if ( reportRec->direction == ZCL_SEND_ATTR_REPORTS )
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    A,@DPTR
        JZ      $+5
        LJMP    ??simplemeter_ProcessInConfigReportCmd_5 & 0xFFFF
// 1640       {
// 1641         if ( reportRec->dataType == attrRec.attr.dataType )
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,#0x4
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        XRL     A,R0
        JNZ     ??simplemeter_ProcessInConfigReportCmd_6
// 1642         {
// 1643           // This the attribute that is to be reported
// 1644           if ( zcl_MandatoryReportableAttribute( &attrRec ) == TRUE )
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,DPL
        ORL     A,DPH
        JNZ     ??simplemeter_ProcessInConfigReportCmd_7
// 1645           {
// 1646             if ( reportRec->minReportInt < SIMPLEMETER_MIN_REPORTING_INTERVAL ||
// 1647                  ( reportRec->maxReportInt != 0 &&
// 1648                    reportRec->maxReportInt < reportRec->minReportInt ) )
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        CLR     C
        MOVX    A,@DPTR
        SUBB    A,#0x5
        INC     DPTR
        MOVX    A,@DPTR
        SUBB    A,#0x0
        JC      ??simplemeter_ProcessInConfigReportCmd_8
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        ORL     A,R1
        JZ      ??simplemeter_ProcessInConfigReportCmd_9
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        PUSH    DPL
          CFI CFA_SP SP+-1
        PUSH    DPH
          CFI CFA_SP SP+-2
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        POP     DPH
          CFI CFA_SP SP+-1
        POP     DPL
          CFI CFA_SP SP+0
        CLR     C
        MOVX    A,@DPTR
        SUBB    A,R0
        INC     DPTR
        MOVX    A,@DPTR
        SUBB    A,R1
        JNC     ??simplemeter_ProcessInConfigReportCmd_9
// 1649             {
// 1650               // Invalid fields
// 1651               status = ZCL_STATUS_INVALID_VALUE;
??simplemeter_ProcessInConfigReportCmd_8:
        MOV     R7,#-0x79
        SJMP    ??simplemeter_ProcessInConfigReportCmd_10
// 1652             }
// 1653             else
// 1654             {
// 1655               // Set the Min and Max Reporting Intervals and Reportable Change
// 1656               //status = zclSetAttrReportInterval( pAttr, cfgReportCmd );
// 1657               status = ZCL_STATUS_UNREPORTABLE_ATTRIBUTE; // for now
??simplemeter_ProcessInConfigReportCmd_9:
        MOV     R7,#-0x74
        SJMP    ??simplemeter_ProcessInConfigReportCmd_10
// 1658             }
// 1659           }
// 1660           else
// 1661           {
// 1662             // Attribute cannot be reported
// 1663             status = ZCL_STATUS_UNREPORTABLE_ATTRIBUTE;
??simplemeter_ProcessInConfigReportCmd_7:
        MOV     R7,#-0x74
        SJMP    ??simplemeter_ProcessInConfigReportCmd_10
// 1664           }
// 1665         }
// 1666         else
// 1667         {
// 1668           // Attribute data type is incorrect
// 1669           status = ZCL_STATUS_INVALID_DATA_TYPE;
??simplemeter_ProcessInConfigReportCmd_6:
        MOV     R7,#-0x73
        SJMP    ??simplemeter_ProcessInConfigReportCmd_10
// 1670         }
// 1671       }
// 1672       else
// 1673       {
// 1674         // We shall expect reports of values of this attribute
// 1675         if ( zcl_MandatoryReportableAttribute( &attrRec ) == TRUE )
??simplemeter_ProcessInConfigReportCmd_5:
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,DPL
        ORL     A,DPH
        JNZ     ??simplemeter_ProcessInConfigReportCmd_11
// 1676         {
// 1677           // Set the Timeout Period
// 1678           //status = zclSetAttrTimeoutPeriod( pAttr, cfgReportCmd );
// 1679           status = ZCL_STATUS_UNSUPPORTED_ATTRIBUTE; // for now
        MOV     R7,#-0x7a
        SJMP    ??simplemeter_ProcessInConfigReportCmd_10
// 1680         }
// 1681         else
// 1682         {
// 1683           // Reports of attribute cannot be received
// 1684           status = ZCL_STATUS_UNSUPPORTED_ATTRIBUTE;
??simplemeter_ProcessInConfigReportCmd_11:
        MOV     R7,#-0x7a
        SJMP    ??simplemeter_ProcessInConfigReportCmd_10
// 1685         }
// 1686       }
// 1687     }
// 1688     else
// 1689     {
// 1690       // Attribute is not supported
// 1691       status = ZCL_STATUS_UNSUPPORTED_ATTRIBUTE;
??simplemeter_ProcessInConfigReportCmd_4:
        MOV     R7,#-0x7a
// 1692     }
// 1693 
// 1694     // If not successful then record the status
// 1695     if ( status != ZCL_STATUS_SUCCESS )
??simplemeter_ProcessInConfigReportCmd_10:
        MOV     A,R7
        JZ      ??simplemeter_ProcessInConfigReportCmd_12
// 1696     {
// 1697       cfgReportRspCmd->attrList[j].status = status;
        MOV     A,R7
        PUSH    A
          CFI CFA_SP SP+-1
        MOV     A,R6
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x4
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x4
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,?V0 + 8
        ADD     A,R0
        MOV     DPL,A
        MOV     A,?V0 + 9
        ADDC    A,R1
        MOV     DPH,A
        INC     DPTR
        POP     A
          CFI CFA_SP SP+0
        MOVX    @DPTR,A
// 1698       cfgReportRspCmd->attrList[j++].attrID = reportRec->attrID;
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        MOV     A,R6
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x4
        MUL     AB
        XCH     A,R0
        MOV     R4,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R4
        MOV     R4,A
        MOV     B,#0x4
        MOV     A,R1
        MUL     AB
        ADD     A,R4
        MOV     R1,A
        MOV     A,?V0 + 8
        ADD     A,R0
        MOV     DPL,A
        MOV     A,?V0 + 9
        ADDC    A,R1
        MOV     DPH,A
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
        INC     R6
// 1699     }
// 1700   } // for loop
??simplemeter_ProcessInConfigReportCmd_12:
        INC     ?V0 + 2
        LJMP    ??simplemeter_ProcessInConfigReportCmd_2 & 0xFFFF
// 1701 
// 1702   if ( j == 0 )
??simplemeter_ProcessInConfigReportCmd_3:
        MOV     A,R6
        JNZ     ??simplemeter_ProcessInConfigReportCmd_13
// 1703   {
// 1704     // Since all attributes were configured successfully, include a single
// 1705     // attribute status record in the response command with the status field
// 1706     // set to SUCCESS and the attribute ID field omitted.
// 1707     cfgReportRspCmd->attrList[0].status = ZCL_STATUS_SUCCESS;
        MOV     DPL,?V0 + 8
        MOV     DPH,?V0 + 9
        INC     DPTR
        MOV     A,#0x0
        MOVX    @DPTR,A
// 1708     cfgReportRspCmd->numAttr = 1;
        MOV     DPL,?V0 + 8
        MOV     DPH,?V0 + 9
        MOV     A,#0x1
        MOVX    @DPTR,A
        SJMP    ??simplemeter_ProcessInConfigReportCmd_14
// 1709   }
// 1710   else
// 1711   {
// 1712     cfgReportRspCmd->numAttr = j;
??simplemeter_ProcessInConfigReportCmd_13:
        MOV     A,R6
        MOV     DPL,?V0 + 8
        MOV     DPH,?V0 + 9
        MOVX    @DPTR,A
// 1713   }
// 1714 
// 1715   // Send the response back
// 1716   zcl_SendConfigReportRspCmd( SIMPLEMETER_ENDPOINT, &(pInMsg->srcAddr),
// 1717                               pInMsg->clusterId, cfgReportRspCmd, ZCL_FRAME_SERVER_CLIENT_DIR,
// 1718                               TRUE, pInMsg->zclHdr.transSeqNum );
??simplemeter_ProcessInConfigReportCmd_14:
        ; Setup parameters for call to function zcl_SendConfigReportRspCmd
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 3,A
        MOV     R0,#?V0 + 3
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 29)
        MOV     ?V0 + 3,#0x1
        MOV     R0,#?V0 + 3
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 30)
        MOV     ?V0 + 3,#0x1
        MOV     R0,#?V0 + 3
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 31)
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 33)
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     A,?V0 + 4
        ADD     A,#0xa
        MOV     R2,A
        MOV     A,?V0 + 5
        ADDC    A,#0x0
        MOV     R3,A
        MOV     R1,#0x9
        LCALL   ??zcl_SendConfigReportRspCmd?relay
        MOV     A,#0x5
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 28)
        MOV     A,R1
// 1719   osal_mem_free( cfgReportRspCmd );
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 8
        MOV     R3,?V0 + 9
        LCALL   ??osal_mem_free?relay
// 1720 
// 1721   return TRUE ;
        MOV     R1,#0x1
??simplemeter_ProcessInConfigReportCmd_1:
        MOV     A,#0x8
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 20)
        MOV     R7,#0xc
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock17
// 1722 }
// 1723 
// 1724 /*********************************************************************
// 1725  * @fn      simplemeter_ProcessInConfigReportRspCmd
// 1726  *
// 1727  * @brief   Process the "Profile" Configure Reporting Response Command
// 1728  *
// 1729  * @param   pInMsg - incoming message to process
// 1730  *
// 1731  * @return  none
// 1732  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1733 static uint8 simplemeter_ProcessInConfigReportRspCmd( zclIncomingMsg_t *pInMsg )
simplemeter_ProcessInConfigReportRspCmd:
          CFI Block cfiBlock18 Using cfiCommon0
          CFI Function simplemeter_ProcessInConfigReportRspCmd
        CODE
// 1734 {
        FUNCALL simplemeter_ProcessInConfigReportRspCmd, zclFindAttrRec
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 24, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 24, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0xe
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 14)
        ; Saved register size: 14
        ; Auto size: 8
        MOV     A,#-0x8
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     ?V0 + 0,R2
        MOV     ?V0 + 1,R3
// 1735   zclCfgReportRspCmd_t *cfgReportRspCmd;
// 1736   zclAttrRec_t attrRec;
// 1737   uint8 i;
// 1738 
// 1739   cfgReportRspCmd = (zclCfgReportRspCmd_t *)pInMsg->attrCmd;
        MOV     A,?V0 + 0
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,?V0 + 1
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
// 1740   for (i = 0; i < cfgReportRspCmd->numAttr; i++)
        MOV     ?V0 + 2,#0x0
??simplemeter_ProcessInConfigReportRspCmd_0:
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,?V0 + 2
        CLR     C
        SUBB    A,R0
        JNC     ??simplemeter_ProcessInConfigReportRspCmd_1
// 1741   {
// 1742     if ( zclFindAttrRec( SIMPLEMETER_ENDPOINT, pInMsg->clusterId,
// 1743                          cfgReportRspCmd->attrList[i].attrID, &attrRec ) )
        ; Setup parameters for call to function zclFindAttrRec
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     ?V0 + 4,DPL
        MOV     ?V0 + 5,DPH
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     A,?V0 + 2
        MOV     R0,?V0 + 2
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x4
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x4
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,R6
        ADD     A,R0
        MOV     DPL,A
        MOV     A,R7
        ADDC    A,R1
        MOV     DPH,A
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        MOV     R1,#0x9
        LCALL   ??zclFindAttrRec?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 22)
        MOV     A,R1
// 1744     {
// 1745       // Notify the device of success (or otherwise) of the its original configure
// 1746       // reporting command, for each attribute.
// 1747     }
// 1748   }
        INC     ?V0 + 2
        SJMP    ??simplemeter_ProcessInConfigReportRspCmd_0
// 1749 
// 1750   return TRUE;
??simplemeter_ProcessInConfigReportRspCmd_1:
        MOV     R1,#0x1
        MOV     A,#0x8
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 14)
        MOV     R7,#0x6
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock18
// 1751 }
// 1752 
// 1753 /*********************************************************************
// 1754  * @fn      simplemeter_ProcessInReadReportCfgCmd
// 1755  *
// 1756  * @brief   Process the "Profile" Read Reporting Configuration Command
// 1757  *
// 1758  * @param   pInMsg - incoming message to process
// 1759  *
// 1760  * @return  none
// 1761  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1762 static uint8 simplemeter_ProcessInReadReportCfgCmd( zclIncomingMsg_t *pInMsg )
simplemeter_ProcessInReadReportCfgCmd:
          CFI Block cfiBlock19 Using cfiCommon0
          CFI Function simplemeter_ProcessInReadReportCfgCmd
        CODE
// 1763 {
        FUNCALL simplemeter_ProcessInReadReportCfgCmd, zclFindAttrRec
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInReadReportCfgCmd, zclAnalogDataType
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInReadReportCfgCmd, zclGetDataTypeLength
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInReadReportCfgCmd, osal_mem_alloc
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInReadReportCfgCmd, zclFindAttrRec
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 36, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 36, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInReadReportCfgCmd, zclAnalogDataType
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInReadReportCfgCmd, zclGetDataTypeLength
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInReadReportCfgCmd, zcl_SendReadReportCfgRspCmd
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 39, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 39, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        FUNCALL simplemeter_ProcessInReadReportCfgCmd, osal_mem_free
        LOCFRAME ISTACK, 0, STACK
        LOCFRAME PSTACK, 0, STACK
        LOCFRAME XSTACK, 34, STACK
        LOCFRAME IOVERLAY, 0, STATIC
        LOCFRAME DOVERLAY, 0, STATIC
        ARGFRAME ISTACK, 0, STACK
        ARGFRAME PSTACK, 0, STACK
        ARGFRAME XSTACK, 34, STACK
        ARGFRAME IOVERLAY, 0, STATIC
        ARGFRAME DOVERLAY, 0, STATIC
        MOV     A,#-0x18
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V15 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V14 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI V13 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI V12 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI V11 load(1, XDATA, add(CFA_XSP16, literal(-11)))
          CFI V10 load(1, XDATA, add(CFA_XSP16, literal(-12)))
          CFI V9 load(1, XDATA, add(CFA_XSP16, literal(-13)))
          CFI V8 load(1, XDATA, add(CFA_XSP16, literal(-14)))
          CFI V7 load(1, XDATA, add(CFA_XSP16, literal(-15)))
          CFI V6 load(1, XDATA, add(CFA_XSP16, literal(-16)))
          CFI V5 load(1, XDATA, add(CFA_XSP16, literal(-17)))
          CFI V4 load(1, XDATA, add(CFA_XSP16, literal(-18)))
          CFI V3 load(1, XDATA, add(CFA_XSP16, literal(-19)))
          CFI V2 load(1, XDATA, add(CFA_XSP16, literal(-20)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-21)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-22)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-23)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-24)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 24)
        ; Saved register size: 24
        ; Auto size: 10
        MOV     A,#-0xa
        LCALL   ?ALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 34)
        MOV     ?V0 + 6,R2
        MOV     ?V0 + 7,R3
// 1764   zclReadReportCfgCmd_t *readReportCfgCmd;
// 1765   zclReadReportCfgRspCmd_t *readReportCfgRspCmd;
// 1766   zclReportCfgRspRec_t *reportRspRec;
// 1767   zclAttrRec_t attrRec;
// 1768   uint8 reportChangeLen;
// 1769   uint8 *dataPtr;
// 1770   uint8 hdrLen;
// 1771   uint8 dataLen = 0;
        MOV     ?V0 + 1,#0x0
// 1772   uint8 status;
// 1773   uint8 i;
// 1774 
// 1775   readReportCfgCmd = (zclReadReportCfgCmd_t *)pInMsg->attrCmd;
        MOV     A,?V0 + 6
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,?V0 + 7
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     ?V0 + 2,R0
        MOV     ?V0 + 3,R1
// 1776 
// 1777   // Find out the response length (Reportable Change field is of variable length)
// 1778   for ( i = 0; i < readReportCfgCmd->numAttr; i++ )
        MOV     R6,#0x0
??simplemeter_ProcessInReadReportCfgCmd_0:
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,R6
        CLR     C
        SUBB    A,R0
        JC      $+5
        LJMP    ??simplemeter_ProcessInReadReportCfgCmd_1 & 0xFFFF
// 1779   {
// 1780     // For supported attributes with 'analog' data type, find out the length of
// 1781     // the Reportable Change field
// 1782     if ( zclFindAttrRec( SIMPLEMETER_ENDPOINT, pInMsg->clusterId,
// 1783                          readReportCfgCmd->attrList[i].attrID, &attrRec ) )
        ; Setup parameters for call to function zclFindAttrRec
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 8,DPL
        MOV     ?V0 + 9,DPH
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 36)
        MOV     A,R6
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x3
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x3
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,?V0 + 2
        ADD     A,R0
        MOV     DPL,A
        MOV     A,?V0 + 3
        ADDC    A,R1
        MOV     DPH,A
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        MOV     R1,#0x9
        LCALL   ??zclFindAttrRec?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 34)
        MOV     A,R1
        JZ      ??simplemeter_ProcessInReadReportCfgCmd_2
// 1784     {
// 1785       if ( zclAnalogDataType( attrRec.attr.dataType ) )
        ; Setup parameters for call to function zclAnalogDataType
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??zclAnalogDataType?relay
        MOV     A,R1
        JZ      ??simplemeter_ProcessInReadReportCfgCmd_2
// 1786       {
// 1787          reportChangeLen = zclGetDataTypeLength( attrRec.attr.dataType );
        ; Setup parameters for call to function zclGetDataTypeLength
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??zclGetDataTypeLength?relay
        MOV     A,R1
        MOV     R7,A
// 1788 
// 1789          // add padding if neede
// 1790          if ( PADDING_NEEDED( reportChangeLen ) )
        MOV     A,R7
        MOV     B,#0x2
        DIV     AB
        MOV     A,B
        JZ      ??simplemeter_ProcessInReadReportCfgCmd_3
// 1791            reportChangeLen++;
        INC     R7
// 1792          dataLen += reportChangeLen;
??simplemeter_ProcessInReadReportCfgCmd_3:
        MOV     A,R7
        ADD     A,?V0 + 1
        MOV     ?V0 + 1,A
// 1793       }
// 1794     }
// 1795   }
??simplemeter_ProcessInReadReportCfgCmd_2:
        INC     R6
        LJMP    ??simplemeter_ProcessInReadReportCfgCmd_0 & 0xFFFF
// 1796 
// 1797   hdrLen = sizeof( zclReadReportCfgRspCmd_t ) + ( readReportCfgCmd->numAttr * sizeof( zclReportCfgRspRec_t ) );
??simplemeter_ProcessInReadReportCfgCmd_1:
        MOV     B,#0xd
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        MOVX    A,@DPTR
        MUL     AB
        ADD     A,#0x1
        MOV     ?V0 + 12,A
// 1798 
// 1799   // Allocate space for the response command
// 1800   readReportCfgRspCmd = (zclReadReportCfgRspCmd_t *)osal_mem_alloc( hdrLen + dataLen );
        ; Setup parameters for call to function osal_mem_alloc
        MOV     ?V0 + 10,?V0 + 12
        MOV     ?V0 + 11,#0x0
        MOV     ?V0 + 8,?V0 + 1
        MOV     ?V0 + 9,#0x0
        MOV     A,?V0 + 10
        ADD     A,?V0 + 8
        MOV     R2,A
        MOV     A,?V0 + 11
        ADDC    A,?V0 + 9
        MOV     R3,A
        LCALL   ??osal_mem_alloc?relay
        MOV     ?V0 + 8,R2
        MOV     ?V0 + 9,R3
        MOV     ?V0 + 4,?V0 + 8
        MOV     ?V0 + 5,?V0 + 9
// 1801   if ( readReportCfgRspCmd == NULL )
        MOV     A,?V0 + 4
        ORL     A,?V0 + 5
        JNZ     ??simplemeter_ProcessInReadReportCfgCmd_4
// 1802     return FALSE; // EMBEDDED RETURN
        MOV     R1,#0x0
        LJMP    ??simplemeter_ProcessInReadReportCfgCmd_5 & 0xFFFF
// 1803 
// 1804   dataPtr = (uint8 *)( (uint8 *)readReportCfgRspCmd + hdrLen );
??simplemeter_ProcessInReadReportCfgCmd_4:
        MOV     ?V0 + 8,?V0 + 12
        MOV     ?V0 + 9,#0x0
        MOV     A,?V0 + 4
        ADD     A,?V0 + 8
        MOV     R0,A
        MOV     A,?V0 + 5
        ADDC    A,?V0 + 9
        MOV     R1,A
        MOV     ?V0 + 14,R0
        MOV     ?V0 + 15,R1
// 1805   readReportCfgRspCmd->numAttr = readReportCfgCmd->numAttr;
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        MOVX    A,@DPTR
        MOV     DPL,?V0 + 4
        MOV     DPH,?V0 + 5
        MOVX    @DPTR,A
// 1806   for (i = 0; i < readReportCfgCmd->numAttr; i++)
        MOV     R6,#0x0
??simplemeter_ProcessInReadReportCfgCmd_6:
        MOV     DPL,?V0 + 2
        MOV     DPH,?V0 + 3
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,R6
        CLR     C
        SUBB    A,R0
        JC      $+5
        LJMP    ??simplemeter_ProcessInReadReportCfgCmd_7 & 0xFFFF
// 1807   {
// 1808     reportRspRec = &(readReportCfgRspCmd->attrList[i]);
        MOV     A,R6
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0xd
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0xd
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,?V0 + 4
        ADD     A,R0
        MOV     DPL,A
        MOV     A,?V0 + 5
        ADDC    A,R1
        MOV     DPH,A
        INC     DPTR
        MOV     R0,DPL
        MOV     R1,DPH
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOV     A,R0
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R1
        MOVX    @DPTR,A
// 1809 
// 1810     if ( zclFindAttrRec( SIMPLEMETER_ENDPOINT, pInMsg->clusterId,
// 1811                          readReportCfgCmd->attrList[i].attrID, &attrRec ) )
        ; Setup parameters for call to function zclFindAttrRec
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     ?V0 + 8,DPL
        MOV     ?V0 + 9,DPH
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 36)
        MOV     A,R6
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x3
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x3
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,?V0 + 2
        ADD     A,R0
        MOV     DPL,A
        MOV     A,?V0 + 3
        ADDC    A,R1
        MOV     DPH,A
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        MOV     R1,#0x9
        LCALL   ??zclFindAttrRec?relay
        MOV     A,#0x2
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 34)
        MOV     A,R1
        JZ      ??simplemeter_ProcessInReadReportCfgCmd_8
// 1812     {
// 1813       if ( zcl_MandatoryReportableAttribute( &attrRec ) == TRUE )
        MOV     A,#0x2
        LCALL   ?XSTACK_DISP0_8
        MOV     A,DPL
        ORL     A,DPH
        JNZ     ??simplemeter_ProcessInReadReportCfgCmd_9
// 1814       {
// 1815         // Get the Reporting Configuration
// 1816         // status = zclReadReportCfg( readReportCfgCmd->attrID[i], reportRspRec );
// 1817         status = ZCL_STATUS_UNREPORTABLE_ATTRIBUTE; // for now
        MOV     ?V0 + 0,#-0x74
// 1818         if ( status == ZCL_STATUS_SUCCESS && zclAnalogDataType( attrRec.attr.dataType ) )
        MOV     A,?V0 + 0
        JNZ     ??simplemeter_ProcessInReadReportCfgCmd_10
        ; Setup parameters for call to function zclAnalogDataType
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??zclAnalogDataType?relay
        MOV     A,R1
        JZ      ??simplemeter_ProcessInReadReportCfgCmd_10
// 1819         {
// 1820           reportChangeLen = zclGetDataTypeLength( attrRec.attr.dataType );
        ; Setup parameters for call to function zclGetDataTypeLength
        MOV     A,#0x6
        LCALL   ?XSTACK_DISP0_8
        MOVX    A,@DPTR
        MOV     R1,A
        LCALL   ??zclGetDataTypeLength?relay
        MOV     A,R1
        MOV     R7,A
// 1821           //osal_memcpy( dataPtr, pBuf, reportChangeLen );
// 1822           reportRspRec->reportableChange = dataPtr;
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        XCH     A,R0
        ADD     A,#0xb
        MOV     DPL,A
        MOV     A,R0
        ADDC    A,#0x0
        MOV     DPH,A
        MOV     A,?V0 + 14
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,?V0 + 15
        MOVX    @DPTR,A
// 1823 
// 1824           // add padding if needed
// 1825           if ( PADDING_NEEDED( reportChangeLen ) )
        MOV     A,R7
        MOV     B,#0x2
        DIV     AB
        MOV     A,B
        JZ      ??simplemeter_ProcessInReadReportCfgCmd_11
// 1826             reportChangeLen++;
        INC     R7
// 1827           dataPtr += reportChangeLen;
??simplemeter_ProcessInReadReportCfgCmd_11:
        MOV     ?V0 + 8,R7
        MOV     ?V0 + 9,#0x0
        MOV     A,?V0 + 14
        ADD     A,?V0 + 8
        MOV     ?V0 + 14,A
        MOV     A,?V0 + 15
        ADDC    A,?V0 + 9
        MOV     ?V0 + 15,A
        SJMP    ??simplemeter_ProcessInReadReportCfgCmd_10
// 1828         }
// 1829       }
// 1830       else
// 1831       {
// 1832         // Attribute not in the Mandatory Reportable Attribute list
// 1833         status = ZCL_STATUS_UNREPORTABLE_ATTRIBUTE;
??simplemeter_ProcessInReadReportCfgCmd_9:
        MOV     ?V0 + 0,#-0x74
        SJMP    ??simplemeter_ProcessInReadReportCfgCmd_10
// 1834       }
// 1835     }
// 1836     else
// 1837     {
// 1838       // Attribute not found
// 1839       status = ZCL_STATUS_UNSUPPORTED_ATTRIBUTE;
??simplemeter_ProcessInReadReportCfgCmd_8:
        MOV     ?V0 + 0,#-0x7a
// 1840     }
// 1841 
// 1842     reportRspRec->status = status;
??simplemeter_ProcessInReadReportCfgCmd_10:
        MOV     A,?V0 + 0
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        MOV     A,?V0 + 0
        MOVX    @DPTR,A
// 1843     reportRspRec->attrID = readReportCfgCmd->attrList[i].attrID;
        MOV     A,R6
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0x3
        MUL     AB
        XCH     A,R0
        MOV     R2,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R2
        MOV     R2,A
        MOV     B,#0x3
        MOV     A,R1
        MUL     AB
        ADD     A,R2
        MOV     R1,A
        MOV     A,?V0 + 2
        ADD     A,R0
        MOV     DPL,A
        MOV     A,?V0 + 3
        ADDC    A,R1
        MOV     DPH,A
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R2,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R3,A
        MOV     DPL,?XSP + 0
        MOV     DPH,?XSP + 1
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     DPH,A
        MOV     DPL,R0
        INC     DPTR
        INC     DPTR
        MOV     A,R2
        MOVX    @DPTR,A
        INC     DPTR
        MOV     A,R3
        MOVX    @DPTR,A
// 1844   }
        INC     R6
        LJMP    ??simplemeter_ProcessInReadReportCfgCmd_6 & 0xFFFF
// 1845 
// 1846   // Send the response back
// 1847   zcl_SendReadReportCfgRspCmd( SIMPLEMETER_ENDPOINT, &(pInMsg->srcAddr),
// 1848                                pInMsg->clusterId, readReportCfgRspCmd, ZCL_FRAME_SERVER_CLIENT_DIR,
// 1849                                TRUE, pInMsg->zclHdr.transSeqNum );
??simplemeter_ProcessInReadReportCfgCmd_7:
        ; Setup parameters for call to function zcl_SendReadReportCfgRspCmd
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     ?V0 + 8,A
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 35)
        MOV     ?V0 + 8,#0x1
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 36)
        MOV     ?V0 + 8,#0x1
        MOV     R0,#?V0 + 8
        LCALL   ?PUSH_XSTACK_I_ONE
          CFI CFA_XSP16 add(XSP16, 37)
        MOV     R0,#?V0 + 4
        LCALL   ?PUSH_XSTACK_I_TWO
          CFI CFA_XSP16 add(XSP16, 39)
        MOV     DPL,?V0 + 6
        MOV     DPH,?V0 + 7
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R4,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R5,A
        MOV     A,?V0 + 6
        ADD     A,#0xa
        MOV     R2,A
        MOV     A,?V0 + 7
        ADDC    A,#0x0
        MOV     R3,A
        MOV     R1,#0x9
        LCALL   ??zcl_SendReadReportCfgRspCmd?relay
        MOV     A,#0x5
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 34)
        MOV     A,R1
// 1850   osal_mem_free( readReportCfgRspCmd );
        ; Setup parameters for call to function osal_mem_free
        MOV     R2,?V0 + 4
        MOV     R3,?V0 + 5
        LCALL   ??osal_mem_free?relay
// 1851 
// 1852   return TRUE;
        MOV     R1,#0x1
??simplemeter_ProcessInReadReportCfgCmd_5:
        MOV     A,#0xa
        LCALL   ?DEALLOC_XSTACK8
          CFI CFA_XSP16 add(XSP16, 24)
        MOV     R7,#0x10
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock19
// 1853 }
// 1854 
// 1855 /*********************************************************************
// 1856  * @fn      simplemeter_ProcessInReadReportCfgRspCmd
// 1857  *
// 1858  * @brief   Process the "Profile" Read Reporting Configuration Response Command
// 1859  *
// 1860  * @param   pInMsg - incoming message to process
// 1861  *
// 1862  * @return  none
// 1863  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1864 static uint8 simplemeter_ProcessInReadReportCfgRspCmd( zclIncomingMsg_t *pInMsg )
simplemeter_ProcessInReadReportCfgRspCmd:
          CFI Block cfiBlock20 Using cfiCommon0
          CFI Function simplemeter_ProcessInReadReportCfgRspCmd
        CODE
// 1865 {
        MOV     A,#-0xa
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V1 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-10)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 10)
        ; Saved register size: 10
        ; Auto size: 0
// 1866   zclReadReportCfgRspCmd_t *readReportCfgRspCmd;
// 1867   zclReportCfgRspRec_t *reportRspRec;
// 1868   uint8 i;
// 1869 
// 1870   readReportCfgRspCmd = (zclReadReportCfgRspCmd_t *)pInMsg->attrCmd;
        MOV     A,R2
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        MOV     R4,A
        MOV     A,R1
        MOV     R5,A
// 1871   for ( i = 0; i < readReportCfgRspCmd->numAttr; i++ )
        MOV     R7,#0x0
??simplemeter_ProcessInReadReportCfgRspCmd_0:
        MOV     DPL,R4
        MOV     DPH,R5
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,R7
        CLR     C
        SUBB    A,R0
        JNC     ??simplemeter_ProcessInReadReportCfgRspCmd_1
// 1872   {
// 1873     reportRspRec = &(readReportCfgRspCmd->attrList[i]);
        MOV     A,R7
        MOV     R0,A
        MOV     R1,#0x0
        MOV     A,R0
        MOV     B,#0xd
        MUL     AB
        MOV     R0,A
        MOV     R6,B
        MOV     B,#0x0
        MUL     AB
        ADD     A,R6
        MOV     R6,A
        MOV     B,#0xd
        MOV     A,R1
        MUL     AB
        ADD     A,R6
        MOV     R1,A
        MOV     A,R4
        ADD     A,R0
        MOV     DPL,A
        MOV     A,R5
        ADDC    A,R1
        MOV     DPH,A
        INC     DPTR
        MOV     ?V0 + 0,DPL
        MOV     ?V0 + 1,DPH
// 1874 
// 1875     // Notify the device of the results of the its original read reporting
// 1876     // configuration command.
// 1877 
// 1878     if ( reportRspRec->status == ZCL_STATUS_SUCCESS )
        MOV     DPL,?V0 + 0
        MOV     DPH,?V0 + 1
        MOVX    A,@DPTR
// 1879     {
// 1880       if ( reportRspRec->direction == ZCL_SEND_ATTR_REPORTS )
// 1881       {
// 1882         // add user code here
// 1883       }
// 1884       else
// 1885       {
// 1886         // expecting attribute reports
// 1887       }
// 1888     }
// 1889   }
        INC     R7
        SJMP    ??simplemeter_ProcessInReadReportCfgRspCmd_0
// 1890 
// 1891   return TRUE;
??simplemeter_ProcessInReadReportCfgRspCmd_1:
        MOV     R1,#0x1
        MOV     R7,#0x2
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock20
// 1892 }
// 1893 
// 1894 /*********************************************************************
// 1895  * @fn      simplemeter_ProcessInReportCmd
// 1896  *
// 1897  * @brief   Process the "Profile" Report Command
// 1898  *
// 1899  * @param   pInMsg - incoming message to process
// 1900  *
// 1901  * @return  none
// 1902  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1903 static uint8 simplemeter_ProcessInReportCmd( zclIncomingMsg_t *pInMsg )
simplemeter_ProcessInReportCmd:
          CFI Block cfiBlock21 Using cfiCommon0
          CFI Function simplemeter_ProcessInReportCmd
        CODE
// 1904 {
        MOV     A,#-0x9
        LCALL   ?BANKED_ENTER_XDATA
          CFI DPH0 load(1, XDATA, add(CFA_XSP16, literal(-1)))
          CFI DPL0 load(1, XDATA, add(CFA_XSP16, literal(-2)))
          CFI ?BRET_EXT load(1, XDATA, add(CFA_XSP16, literal(-3)))
          CFI ?RET_HIGH load(1, XDATA, add(CFA_XSP16, literal(-4)))
          CFI ?RET_LOW load(1, XDATA, add(CFA_XSP16, literal(-5)))
          CFI R7 load(1, XDATA, add(CFA_XSP16, literal(-6)))
          CFI V0 load(1, XDATA, add(CFA_XSP16, literal(-7)))
          CFI VB load(1, XDATA, add(CFA_XSP16, literal(-8)))
          CFI R6 load(1, XDATA, add(CFA_XSP16, literal(-9)))
          CFI CFA_SP SP+0
          CFI CFA_XSP16 add(XSP16, 9)
        ; Saved register size: 9
        ; Auto size: 0
// 1905   zclReportCmd_t *reportCmd;
// 1906   uint8 i;
// 1907 
// 1908   reportCmd = (zclReportCmd_t *)pInMsg->attrCmd;
        MOV     A,R2
        ADD     A,#0x17
        MOV     DPL,A
        MOV     A,R3
        ADDC    A,#0x0
        MOV     DPH,A
        MOVX    A,@DPTR
        MOV     R0,A
        INC     DPTR
        MOVX    A,@DPTR
        MOV     R1,A
        MOV     A,R0
        MOV     R6,A
        MOV     A,R1
        MOV     R7,A
// 1909   for (i = 0; i < reportCmd->numAttr; i++)
        MOV     R4,#0x0
??simplemeter_ProcessInReportCmd_0:
        MOV     DPL,R6
        MOV     DPH,R7
        MOVX    A,@DPTR
        MOV     R0,A
        MOV     A,R4
        CLR     C
        SUBB    A,R0
        JNC     ??simplemeter_ProcessInReportCmd_1
        INC     R4
        SJMP    ??simplemeter_ProcessInReportCmd_0
// 1910   {
// 1911     // add user code here
// 1912   }
// 1913 
// 1914   return TRUE;
??simplemeter_ProcessInReportCmd_1:
        MOV     R1,#0x1
        MOV     R7,#0x1
        LJMP    ?BANKED_LEAVE_XDATA
          CFI EndBlock cfiBlock21
// 1915 }
// 1916 #endif // ZCL_REPORT
// 1917 
// 1918 /*********************************************************************
// 1919  * @fn      simplemeter_ProcessInDefaultRspCmd
// 1920  *
// 1921  * @brief   Process the "Profile" Default Response Command
// 1922  *
// 1923  * @param   pInMsg - incoming message to process
// 1924  *
// 1925  * @return  none
// 1926  */

        RSEG BANKED_CODE:CODE:NOROOT(0)
// 1927 static uint8 simplemeter_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg )
simplemeter_ProcessInDefaultRspCmd:
          CFI Block cfiBlock22 Using cfiCommon0
          CFI Function simplemeter_ProcessInDefaultRspCmd
        CODE
// 1928 {
        ; Saved register size: 0
        ; Auto size: 0
// 1929   // zclDefaultRspCmd_t *defaultRspCmd = (zclDefaultRspCmd_t *)pInMsg->attrCmd;
// 1930 
// 1931   // Device is notified of the Default Response command.
// 1932 
// 1933   return TRUE;
        MOV     R1,#0x1
        LJMP    ?BRET
          CFI EndBlock cfiBlock22
// 1934 }

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for numSeAttr>`:
        DATA8
        DB 5

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for numBasicAttr>`:
        DATA8
        DB 2

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for simplemeter_GenCmdCallbacks>`:
        DATA16
        DW ??simplemeter_BasicResetCB?relay
        DW ??simplemeter_IdentifyCB?relay
        DW ??simplemeter_IdentifyQueryRspCB?relay
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW ??simplemeter_AlarmCB?relay
        DW 0H
        DW 0H

        RSEG XDATA_ID:CODE:NOROOT(0)
`?<Initializer for simplemeter_SECmdCallbacks>`:
        DATA16
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW ??simplemeter_GetProfileRspCB?relay
        DW 0H
        DW 0H
        DW 0H
        DW ??simplemeter_GetProfileCmdCB?relay
        DW ??simplemeter_ReqMirrorRspCB?relay
        DW ??simplemeter_MirrorRemRspCB?relay
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H
        DW 0H

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_Init?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_Init

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_event_loop?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_event_loop

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessZDOMsgs?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessZDOMsgs

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessIdentifyTimeChange?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessIdentifyTimeChange

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_HandleKeys?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_HandleKeys

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ValidateAttrDataCB?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ValidateAttrDataCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_BasicResetCB?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_BasicResetCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_IdentifyCB?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_IdentifyCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_IdentifyQueryRspCB?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_IdentifyQueryRspCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_AlarmCB?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_AlarmCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_GetProfileCmdCB?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_GetProfileCmdCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_GetProfileRspCB?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_GetProfileRspCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ReqMirrorRspCB?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ReqMirrorRspCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_MirrorRemRspCB?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_MirrorRemRspCB

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessZCLMsg?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessZCLMsg

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessInReadRspCmd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessInReadRspCmd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessInWriteRspCmd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessInWriteRspCmd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessInConfigReportCmd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessInConfigReportCmd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessInConfigReportRspCmd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessInConfigReportRspCmd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessInReadReportCfgCmd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessInReadReportCfgCmd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessInReadReportCfgRspCmd?rela:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessInReadReportCfgRspCmd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessInReportCmd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessInReportCmd

        RSEG BANK_RELAYS:CODE:REORDER:NOROOT(0)
??simplemeter_ProcessInDefaultRspCmd?relay:
        CODE
        LCALL   ?BDISPATCH
        DATA24
        DC24    simplemeter_ProcessInDefaultRspCmd

        RSEG XDATA_ROM_C:CONST:REORDER:NOROOT(0)
        DATA8
`?<Constant {10485761L, 10485762L, 10485763L, 1`:
        DATA32
        DD 10485761
        DD 10485762
        DD 10485763
        DD 10485764
        DD 10485765

        END
// 1935 
// 1936 #if defined ( ZCL_DISCOVER )
// 1937 /*********************************************************************
// 1938  * @fn      simplemeter_ProcessInDiscRspCmd
// 1939  *
// 1940  * @brief   Process the "Profile" Discover Response Command
// 1941  *
// 1942  * @param   pInMsg - incoming message to process
// 1943  *
// 1944  * @return  none
// 1945  */
// 1946 static uint8 simplemeter_ProcessInDiscRspCmd( zclIncomingMsg_t *pInMsg )
// 1947 {
// 1948   zclDiscoverRspCmd_t *discoverRspCmd;
// 1949   uint8 i;
// 1950 
// 1951   discoverRspCmd = (zclDiscoverRspCmd_t *)pInMsg->attrCmd;
// 1952   for ( i = 0; i < discoverRspCmd->numAttr; i++ )
// 1953   {
// 1954     // Device is notified of the result of its attribute discovery command.
// 1955   }
// 1956 
// 1957   return TRUE;
// 1958 }
// 1959 #endif // ZCL_DISCOVER
// 1960 
// 1961 /****************************************************************************
// 1962 ****************************************************************************/
// 
// 3 865 bytes in segment BANKED_CODE
//   138 bytes in segment BANK_RELAYS
//    98 bytes in segment XDATA_I
//    98 bytes in segment XDATA_ID
//    20 bytes in segment XDATA_ROM_C
//    18 bytes in segment XDATA_Z
// 
// 4 101 bytes of CODE  memory
//    20 bytes of CONST memory
//   116 bytes of XDATA memory
//
//Errors: none
//Warnings: none
